<!DOCTYPE html>
<!-- Generated by Cython 0.29.28 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: _marching_cubes_lewiner_cy.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.28</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="_marching_cubes_lewiner_cy.c">_marching_cubes_lewiner_cy.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="c"># -*- coding: utf-8 -*-</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="c">#cython: cdivision=True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="c">#cython: boundscheck=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="c">#cython: nonecheck=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="c">#cython: wraparound=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="c">#cython: language_level=2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="sd">&quot;&quot;&quot;  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: <span class="sd">Copyright (C) 2011, the scikit-image team All rights reserved.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: <span class="sd">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>: <span class="sd">        Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>: <span class="sd">        Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: <span class="sd">        Neither the name of skimage nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: <span class="sd">THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS&#39;&#39; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: <span class="sd">This is an implementation of the marching cubes algorithm proposed in:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="sd">Efficient implementation of Marching Cubes&#39; cases with topological guarantees.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: <span class="sd">Thomas Lewiner, Helio Lopes, Antonio Wilson Vieira and Geovan Tavares.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: <span class="sd">Journal of Graphics Tools 8(2): pp. 1-15 (december 2003)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="sd">This algorithm has the advantage that it provides topologically correct</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="sd">results, and the algorithms implementation is relatively simple. Most</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="sd">of the magic is in the lookup tables, which are provided as open source.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="sd">Originally implemented in C++ by Thomas Lewiner in 2002, ported to Cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: <span class="sd">by Almar Klein in 2012. Adapted for scikit-image in 2016.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="c"># Cython specific imports</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0036</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0037</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="k">import</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: <span class="c"># Enable low level memory management</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: <span class="c"># from libc.stdlib cimport malloc, free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;stdlib.h&quot;</span><span class="p">:</span> <span class="c"># The cimport does not work on my Linux Laptop</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>:    <span class="n">void</span> <span class="n">free</span><span class="p">(</span><span class="n">void</span><span class="o">*</span> <span class="n">ptr</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>:    <span class="n">void</span><span class="o">*</span> <span class="n">malloc</span><span class="p">(</span><span class="n">size_t</span> <span class="n">size</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="c"># Define tiny winy number</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0047</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">FLT_EPSILON</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">spacing</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#0.0000001</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_spacing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__25, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON = __pyx_t_3;
/* … */
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_float_1_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
</pre><pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="c"># Define abs function for doubles</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0050</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">dabs</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mf">0</span> <span class="k">else</span> <span class="o">-</span><span class="n">a</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE double __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(double __pyx_v_a) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dabs", 0);
  if (((__pyx_v_a &gt;= 0.0) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = (-__pyx_v_a);
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0051</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">imin</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">&lt;</span><span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_imin(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("imin", 0);
  if (((__pyx_v_a &lt; __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="c"># todo: allow dynamic isovalue?</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="c"># todo: can we disable Cython from checking for zero division? Sometimes we know that it never happens!</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0056</span>: <span class="k">def</span> <span class="nf">remove_degenerate_faces</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="o">*</span><span class="n">arrays</span><span class="p">):</span></pre>
<pre class='cython code score-63 '>/* Python wrapper */
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_1remove_degenerate_faces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_1remove_degenerate_faces = {"remove_degenerate_faces", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_1remove_degenerate_faces, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_1remove_degenerate_faces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_faces = 0;
  PyObject *__pyx_v_arrays = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove_degenerate_faces (wrapper)", 0);
  if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 2) {
    __pyx_v_arrays = <span class='py_c_api'>PyTuple_GetSlice</span>(__pyx_args, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));
    if (unlikely(!__pyx_v_arrays)) {
      <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
      return NULL;
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_arrays);
  } else {
    __pyx_v_arrays = __pyx_empty_tuple; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  }
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_faces,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        default:
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_faces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("remove_degenerate_faces", 0, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t used_pos_args = (pos_args &lt; 2) ? pos_args : 2;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, used_pos_args, "remove_degenerate_faces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &lt; 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vertices = values[0];
    __pyx_v_faces = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("remove_degenerate_faces", 0, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_arrays); __pyx_v_arrays = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.remove_degenerate_faces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_remove_degenerate_faces(__pyx_self, __pyx_v_vertices, __pyx_v_faces, __pyx_v_arrays);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arrays);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_remove_degenerate_faces(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vertices, PyObject *__pyx_v_faces, PyObject *__pyx_v_arrays) {
  PyObject *__pyx_v_vertices_map0 = NULL;
  PyObject *__pyx_v_vertices_map1 = NULL;
  PyObject *__pyx_v_faces_ok = NULL;
  __Pyx_memviewslice __pyx_v_vertices_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_faces_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vertices_map1_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_faces_ok_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_j;
  int __pyx_v_i1;
  int __pyx_v_i2;
  int __pyx_v_i3;
  PyObject *__pyx_v_vertices_ok = NULL;
  PyObject *__pyx_v_vertices_map2 = NULL;
  PyObject *__pyx_v_faces2 = NULL;
  PyObject *__pyx_v_vertices2 = NULL;
  PyObject *__pyx_v_arrays2 = NULL;
  PyObject *__pyx_v_arr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove_degenerate_faces", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.remove_degenerate_faces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices_map0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices_map1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_faces_ok);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertices_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_faces_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertices_map1_, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_faces_ok_, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices_ok);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices_map2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_faces2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arrays2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(23, __pyx_n_s_vertices, __pyx_n_s_faces, __pyx_n_s_arrays, __pyx_n_s_vertices_map0, __pyx_n_s_vertices_map1, __pyx_n_s_faces_ok, __pyx_n_s_vertices_2, __pyx_n_s_v1, __pyx_n_s_v2, __pyx_n_s_v3, __pyx_n_s_faces_2, __pyx_n_s_vertices_map1_2, __pyx_n_s_faces_ok_2, __pyx_n_s_j, __pyx_n_s_i1, __pyx_n_s_i2, __pyx_n_s_i3, __pyx_n_s_vertices_ok, __pyx_n_s_vertices_map2, __pyx_n_s_faces2, __pyx_n_s_vertices2, __pyx_n_s_arrays2, __pyx_n_s_arr);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_1remove_degenerate_faces, NULL, __pyx_n_s_simnibs_segmentation__marching_c_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_remove_degenerate_faces, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_simnibs_segmentation__marching_c, __pyx_n_s_remove_degenerate_faces, 56, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0057</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>:     <span class="n">vertices_map0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_vertices);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vertices_map0 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0059</span>:     <span class="n">vertices_map1</span> <span class="o">=</span> <span class="n">vertices_map0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices_map0, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_6 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vertices_map1 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>:     <span class="n">faces_ok</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">faces</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_faces);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_faces_ok = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0061</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0062</span>:     <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">vertices_</span> <span class="o">=</span> <span class="n">vertices</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  __pyx_v_vertices_ = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0063</span>:     <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0064</span>:     <span class="k">cdef</span> <span class="kt">int</span> [<span class="p">:,</span> <span class="p">:]</span>  <span class="n">faces_</span> <span class="o">=</span> <span class="n">faces</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_v_faces, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  __pyx_v_faces_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0065</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0066</span>:     <span class="k">cdef</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">vertices_map1_</span> <span class="o">=</span> <span class="n">vertices_map1</span></pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_vertices_map1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 66, __pyx_L1_error)</span>
  __pyx_v_vertices_map1_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0067</span>:     <span class="k">cdef</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">faces_ok_</span> <span class="o">=</span> <span class="n">faces_ok</span></pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_faces_ok, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 67, __pyx_L1_error)</span>
  __pyx_v_faces_ok_ = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i1</span><span class="p">,</span> <span class="nf">i2</span><span class="p">,</span> <span class="nf">i3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>:     <span class="c"># Iterate over all faces. When we encounter a degenerate triangle,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>:     <span class="c"># we update the vertex map, i.e. we merge the corresponding vertices.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0073</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">faces_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = (__pyx_v_faces_.shape[0]);
  __pyx_t_10 = __pyx_t_3;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0074</span>:         <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span> <span class="o">=</span> <span class="n">faces_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mf">0</span><span class="p">],</span> <span class="n">faces_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mf">1</span><span class="p">],</span> <span class="n">faces_</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_j;
    __pyx_t_13 = 0;
    __pyx_t_14 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_faces_.data + __pyx_t_12 * __pyx_v_faces_.strides[0]) ) + __pyx_t_13 * __pyx_v_faces_.strides[1]) )));
    __pyx_t_13 = __pyx_v_j;
    __pyx_t_12 = 1;
    __pyx_t_15 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_faces_.data + __pyx_t_13 * __pyx_v_faces_.strides[0]) ) + __pyx_t_12 * __pyx_v_faces_.strides[1]) )));
    __pyx_t_12 = __pyx_v_j;
    __pyx_t_13 = 2;
    __pyx_t_16 = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_faces_.data + __pyx_t_12 * __pyx_v_faces_.strides[0]) ) + __pyx_t_13 * __pyx_v_faces_.strides[1]) )));
    __pyx_v_i1 = __pyx_t_14;
    __pyx_v_i2 = __pyx_t_15;
    __pyx_v_i3 = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0075</span>:         <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">vertices_</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">vertices_</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span> <span class="n">vertices_</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17.data = __pyx_v_vertices_.data;
    __pyx_t_17.memview = __pyx_v_vertices_.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_17, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i1;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_vertices_.strides[0];
        __pyx_t_17.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_17.shape[0] = __pyx_v_vertices_.shape[1];
__pyx_t_17.strides[0] = __pyx_v_vertices_.strides[1];
    __pyx_t_17.suboffsets[0] = -1;

__pyx_t_18.data = __pyx_v_vertices_.data;
    __pyx_t_18.memview = __pyx_v_vertices_.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_18, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i2;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_vertices_.strides[0];
        __pyx_t_18.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_18.shape[0] = __pyx_v_vertices_.shape[1];
__pyx_t_18.strides[0] = __pyx_v_vertices_.strides[1];
    __pyx_t_18.suboffsets[0] = -1;

__pyx_t_19.data = __pyx_v_vertices_.data;
    __pyx_t_19.memview = __pyx_v_vertices_.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_19, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i3;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_vertices_.strides[0];
        __pyx_t_19.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_19.shape[0] = __pyx_v_vertices_.shape[1];
__pyx_t_19.strides[0] = __pyx_v_vertices_.strides[1];
    __pyx_t_19.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_v1, 1);
    __pyx_v_v1 = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v2, 1);
    __pyx_v_v2 = __pyx_t_18;
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v3, 1);
    __pyx_v_v3 = __pyx_t_19;
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0076</span>:         <span class="k">if</span> <span class="n">v1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v1</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">[</span><span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v1.data + __pyx_t_13 * __pyx_v_v1.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v2.data + __pyx_t_12 * __pyx_v_v2.strides[0]) )))) != 0);
    if (__pyx_t_21) {
    } else {
      __pyx_t_20 = __pyx_t_21;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_12 = 1;
    __pyx_t_13 = 1;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v1.data + __pyx_t_12 * __pyx_v_v1.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v2.data + __pyx_t_13 * __pyx_v_v2.strides[0]) )))) != 0);
    if (__pyx_t_21) {
    } else {
      __pyx_t_20 = __pyx_t_21;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_13 = 2;
    __pyx_t_12 = 2;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v1.data + __pyx_t_13 * __pyx_v_v1.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v2.data + __pyx_t_12 * __pyx_v_v2.strides[0]) )))) != 0);
    __pyx_t_20 = __pyx_t_21;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_20) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0077</span>:             <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">imin</span><span class="p">(</span><span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_i1;
      __pyx_t_13 = __pyx_v_i2;
      __pyx_t_16 = __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_imin((*((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_12 * __pyx_v_vertices_map1_.strides[0]) ))), (*((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) ))));
      __pyx_t_13 = __pyx_v_i1;
      *((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) )) = __pyx_t_16;
      __pyx_t_13 = __pyx_v_i2;
      *((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) )) = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0078</span>:             <span class="n">faces_ok_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_j;
      *((int *) ( /* dim=0 */ (__pyx_v_faces_ok_.data + __pyx_t_13 * __pyx_v_faces_ok_.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0079</span>:         <span class="k">if</span> <span class="n">v1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">v3</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v3</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v1</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v3</span><span class="p">[</span><span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v1.data + __pyx_t_13 * __pyx_v_v1.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v3.data + __pyx_t_12 * __pyx_v_v3.strides[0]) )))) != 0);
    if (__pyx_t_21) {
    } else {
      __pyx_t_20 = __pyx_t_21;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_12 = 1;
    __pyx_t_13 = 1;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v1.data + __pyx_t_12 * __pyx_v_v1.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v3.data + __pyx_t_13 * __pyx_v_v3.strides[0]) )))) != 0);
    if (__pyx_t_21) {
    } else {
      __pyx_t_20 = __pyx_t_21;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_13 = 2;
    __pyx_t_12 = 2;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v1.data + __pyx_t_13 * __pyx_v_v1.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v3.data + __pyx_t_12 * __pyx_v_v3.strides[0]) )))) != 0);
    __pyx_t_20 = __pyx_t_21;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_20) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0080</span>:             <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span> <span class="o">=</span> <span class="n">imin</span><span class="p">(</span><span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i3</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_i1;
      __pyx_t_13 = __pyx_v_i3;
      __pyx_t_16 = __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_imin((*((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_12 * __pyx_v_vertices_map1_.strides[0]) ))), (*((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) ))));
      __pyx_t_13 = __pyx_v_i1;
      *((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) )) = __pyx_t_16;
      __pyx_t_13 = __pyx_v_i3;
      *((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) )) = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0081</span>:             <span class="n">faces_ok_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_j;
      *((int *) ( /* dim=0 */ (__pyx_v_faces_ok_.data + __pyx_t_13 * __pyx_v_faces_ok_.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0082</span>:         <span class="k">if</span> <span class="n">v2</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">v3</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v2</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v3</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v2</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v3</span><span class="p">[</span><span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v2.data + __pyx_t_13 * __pyx_v_v2.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v3.data + __pyx_t_12 * __pyx_v_v3.strides[0]) )))) != 0);
    if (__pyx_t_21) {
    } else {
      __pyx_t_20 = __pyx_t_21;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_12 = 1;
    __pyx_t_13 = 1;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v2.data + __pyx_t_12 * __pyx_v_v2.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v3.data + __pyx_t_13 * __pyx_v_v3.strides[0]) )))) != 0);
    if (__pyx_t_21) {
    } else {
      __pyx_t_20 = __pyx_t_21;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_13 = 2;
    __pyx_t_12 = 2;
    __pyx_t_21 = (((*((float *) ( /* dim=0 */ (__pyx_v_v2.data + __pyx_t_13 * __pyx_v_v2.strides[0]) ))) == (*((float *) ( /* dim=0 */ (__pyx_v_v3.data + __pyx_t_12 * __pyx_v_v3.strides[0]) )))) != 0);
    __pyx_t_20 = __pyx_t_21;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_20) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>:             <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span> <span class="o">=</span> <span class="n">imin</span><span class="p">(</span><span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i2</span><span class="p">],</span> <span class="n">vertices_map1_</span><span class="p">[</span><span class="n">i3</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_i2;
      __pyx_t_13 = __pyx_v_i3;
      __pyx_t_16 = __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_imin((*((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_12 * __pyx_v_vertices_map1_.strides[0]) ))), (*((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) ))));
      __pyx_t_13 = __pyx_v_i2;
      *((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) )) = __pyx_t_16;
      __pyx_t_13 = __pyx_v_i3;
      *((int *) ( /* dim=0 */ (__pyx_v_vertices_map1_.data + __pyx_t_13 * __pyx_v_vertices_map1_.strides[0]) )) = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0084</span>:             <span class="n">faces_ok_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_j;
      *((int *) ( /* dim=0 */ (__pyx_v_faces_ok_.data + __pyx_t_13 * __pyx_v_faces_ok_.strides[0]) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>:     <span class="c"># Create mask and mapping to new vertex indices</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0087</span>:     <span class="n">vertices_ok</span> <span class="o">=</span> <span class="n">vertices_map1</span> <span class="o">==</span> <span class="n">vertices_map0</span></pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_vertices_map1, __pyx_v_vertices_map0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  __pyx_v_vertices_ok = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>:     <span class="n">vertices_map2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">vertices_ok</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_v_vertices_ok) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vertices_ok);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_vertices_map2 = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0089</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0090</span>:     <span class="c"># Apply selection and mapping</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>:     <span class="n">faces2</span> <span class="o">=</span> <span class="n">vertices_map2</span><span class="p">[</span><span class="n">vertices_map1</span><span class="p">[</span><span class="n">faces</span><span class="p">[</span><span class="n">faces_ok</span><span class="o">&gt;</span><span class="mf">0</span><span class="p">]]]</span></pre>
<pre class='cython code score-14 '>  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_faces_ok, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_faces, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices_map1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices_map2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_faces2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>:     <span class="n">vertices2</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">vertices_ok</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_vertices, __pyx_v_vertices_ok);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_v_vertices2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0093</span>:     <span class="n">arrays2</span> <span class="o">=</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="n">vertices_ok</span><span class="p">]</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">]</span></pre>
<pre class='cython code score-17 '>  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = __pyx_v_arrays; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
    #else
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_arr, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_arr, __pyx_v_vertices_ok);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_5, (PyObject*)__pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_arrays2 = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0094</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0095</span>:     <span class="k">return</span> <span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">faces2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">arrays2</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_vertices2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_faces2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_faces2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_faces2);
  __pyx_t_4 = <span class='py_c_api'>PyList_AsTuple</span>(__pyx_v_arrays2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0096</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0098</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Cell</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell {
  PyObject_HEAD
  struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_vtab;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *luts;
  int x;
  int y;
  int z;
  int step;
  double v0;
  double v1;
  double v2;
  double v3;
  double v4;
  double v5;
  double v6;
  double v7;
  double *vv;
  double *vg;
  double vmax;
  double v12_x;
  double v12_y;
  double v12_z;
  double v12_xg;
  double v12_yg;
  double v12_zg;
  int v12_calculated;
  int index;
  int nx;
  int ny;
  int nz;
  int *faceLayer;
  int *faceLayer1;
  int *faceLayer2;
  float *_vertices;
  float *_normals;
  float *_values;
  int _vertexCount;
  int _vertexMaxCount;
  int *_faces;
  int _faceCount;
  int _faceMaxCount;
};
/* … */
struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell {
  void (*_increase_size_vertices)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *);
  void (*_increase_size_faces)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *);
  int (*add_vertex)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, float, float, float);
  void (*add_gradient)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, int, float, float, float);
  void (*add_gradient_from_index)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, int, int, float);
  PyObject *(*add_face)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, int);
  void (*new_z_value)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *);
  void (*set_cube)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, double, int, int, int, int, double, double, double, double, double, double, double, double);
  void (*add_triangles)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *, int, int);
  void (*add_triangles2)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *, int, int, int);
  void (*_add_face_from_edge_index)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, int);
  int (*get_index_in_facelayer)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *, int);
  void (*prepare_for_adding_triangles)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *);
  void (*calculate_center_vertex)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *);
};
static struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_vtabptr_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell;

</pre><pre class="cython line score-0">&#xA0;<span class="">0099</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; Class to keep track of some stuff during the whole cube marching</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>: <span class="sd">    procedure. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: <span class="sd">    This &quot;struct&quot; keeps track of the current cell location, and the values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="sd">    of corners of the cube. Gradients for the cube corners are calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: <span class="sd">    when needed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>: <span class="sd">    Additionally, it keeps track of the array of vertices, faces and normals.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>: <span class="sd">    Notes on vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>: <span class="sd">    -----------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>: <span class="sd">    The vertices are stored in a C-array that is increased in size with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>: <span class="sd">    factors of two if needed. The same applies to the faces and normals.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: <span class="sd">    Notes on faces</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: <span class="sd">    --------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>: <span class="sd">    To keep track of the vertices already defined, this class maintains</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: <span class="sd">    two faceLayer arrays. faceLayer1 is of the current layer (z-value)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: <span class="sd">    and faceLayer2 is of the next. Both face layers have 4 elements per</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: <span class="sd">    cell in that layer, 1 for each unique edge per cell (see </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>: <span class="sd">    get_index_in_facelayer). These are initialized as -1, and set to the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>: <span class="sd">    index in the vertex array when a new vertex is created.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>: <span class="sd">    In summary, this allows us to keep track of the already created</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>: <span class="sd">    vertices without keeping a very big array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>: <span class="sd">    Notes on normals</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>: <span class="sd">    ----------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: <span class="sd">    The normal is simply defined as the gradient. Each time that a face is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: <span class="sd">    created, we also add the gradient of that vertex position to the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: <span class="sd">    normals array. The gradients are all calculated from the differences between</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: <span class="sd">    the 8 corners of the current cube, but because the final value of a normal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: <span class="sd">    was contributed from multiple cells, the normals are quite accurate.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>:     <span class="c"># Reference to LUTS object</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>:     <span class="k">cdef</span> <span class="kt">LutProvider</span> <span class="nf">luts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>:     <span class="c"># Location of cube</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>:     <span class="c"># Stepsize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>:     <span class="c"># Values of cube corners (isovalue subtracted)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v5</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v6</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v7</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>:     <span class="c"># Small arrays to store the above values in (allowing indexing)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>:     <span class="c"># and also the gradient at these points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>:     <span class="k">cdef</span> <span class="kt">double</span> *<span class="nf">vv</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>:     <span class="k">cdef</span> <span class="kt">double</span> *<span class="nf">vg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>:     <span class="c"># Max value of the eight corners</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">vmax</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>:     <span class="c"># Vertex position of center of cube (only calculated if needed)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v12_x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v12_y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v12_z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0167</span>:     <span class="c"># And corresponding gradient</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0168</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v12_xg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0169</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v12_yg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v12_zg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">v12_calculated</span> <span class="c"># a boolean </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>:     <span class="c"># The index value, our magic 256 bit word</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0174</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">index</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0176</span>:     <span class="c"># Dimensions of the total volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0177</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0181</span>:     <span class="c"># Arrays with face information</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0182</span>:     <span class="k">cdef</span> <span class="kt">int</span> *<span class="nf">faceLayer</span> <span class="c"># The current facelayer (reference-copy of one of the below)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0183</span>:     <span class="k">cdef</span> <span class="kt">int</span> *<span class="nf">faceLayer1</span> <span class="c"># The actual first face layer </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0184</span>:     <span class="k">cdef</span> <span class="kt">int</span> *<span class="nf">faceLayer2</span> <span class="c"># The actual second face layer </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0186</span>:     <span class="c"># Stuff to store the output vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0187</span>:     <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">_vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0188</span>:     <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">_normals</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0189</span>:     <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">_values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0190</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_vertexCount</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0191</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_vertexMaxCount</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>:     <span class="c"># Stuff to store the output faces</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>:     <span class="k">cdef</span> <span class="kt">int</span> *<span class="nf">_faces</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_faceCount</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_faceMaxCount</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: </pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0199</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">LutProvider</span> <span class="n">luts</span><span class="p">,</span> <span class="nb">int</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ny</span><span class="p">,</span> <span class="nb">int</span> <span class="n">nz</span><span class="p">):</span></pre>
<pre class='cython code score-59 '>/* Python wrapper */
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_luts = 0;
  int __pyx_v_nx;
  int __pyx_v_ny;
  int __pyx_v_nz;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_luts,&amp;__pyx_n_s_nx,&amp;__pyx_n_s_ny,&amp;__pyx_n_s_nz,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_luts)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_luts = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *)values[0]);
    __pyx_v_nx = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_nx == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
    __pyx_v_ny = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_ny == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
    __pyx_v_nz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_nz == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Cell.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_luts), __pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider, 1, "luts", 0))) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell___init__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self), __pyx_v_luts, __pyx_v_nx, __pyx_v_ny, __pyx_v_nz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell___init__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_luts, int __pyx_v_nx, int __pyx_v_ny, int __pyx_v_nz) {
  int __pyx_v_i;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0200</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">luts</span> <span class="o">=</span> <span class="n">luts</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_luts));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_luts));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;luts);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;luts));
  __pyx_v_self-&gt;luts = __pyx_v_luts;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0201</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nx;
  __pyx_t_2 = __pyx_v_ny;
  __pyx_t_3 = __pyx_v_nz;
  __pyx_v_self-&gt;nx = __pyx_t_1;
  __pyx_v_self-&gt;ny = __pyx_t_2;
  __pyx_v_self-&gt;nz = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0203</span>:         <span class="c"># Allocate face layers</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0204</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">int</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">*</span><span class="mf">4</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;faceLayer1 = ((int *)malloc((((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;ny) * 4) * (sizeof(int)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">int</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">*</span><span class="mf">4</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;faceLayer2 = ((int *)malloc((((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;ny) * 4) * (sizeof(int)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0206</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0207</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">*</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;ny) * 4);
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_5; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;faceLayer1[__pyx_v_i]) = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0209</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;faceLayer2[__pyx_v_i]) = -1;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0210</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;faceLayer1;
  __pyx_v_self-&gt;faceLayer = __pyx_t_6;
</pre><pre class="cython line score-0">&#xA0;<span class="">0211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0213</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_2__cinit__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_2__cinit__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>:         <span class="c"># Init tiny arrays for vertices and gradients at the vertices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0216</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">double</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="mf">8</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;vv = ((double *)malloc((8 * (sizeof(double)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0217</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">double</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="mf">8</span><span class="o">*</span><span class="mf">3</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;vg = ((double *)malloc((24 * (sizeof(double)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>:         <span class="c"># Init face layers</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0220</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;faceLayer1 = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0221</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;faceLayer2 = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0223</span>:         <span class="c"># Init vertices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_vertexCount = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span> <span class="o">=</span> <span class="mf">8</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_vertexMaxCount = 8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span><span class="o">*</span><span class="mf">3</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_vertices = ((float *)malloc(((__pyx_v_self-&gt;_vertexMaxCount * 3) * (sizeof(float)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0227</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span><span class="o">*</span><span class="mf">3</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_normals = ((float *)malloc(((__pyx_v_self-&gt;_vertexMaxCount * 3) * (sizeof(float)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_values = ((float *)malloc((__pyx_v_self-&gt;_vertexMaxCount * (sizeof(float)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0229</span>:         <span class="c"># Clear normals and values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0231</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_vertexMaxCount;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;_values[__pyx_v_i]) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0233</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0234</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_self-&gt;_normals[((__pyx_v_i * 3) + __pyx_v_j)]) = 0.0;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0235</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>:         <span class="c"># Init faces</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0237</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_faceCount = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0238</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faceMaxCount</span> <span class="o">=</span> <span class="mf">8</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_faceMaxCount = 8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0239</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faces</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">int</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faceMaxCount</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_faces = ((int *)malloc((__pyx_v_self-&gt;_faceMaxCount * (sizeof(int)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0242</span>:     <span class="k">def</span> <span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>/* Python wrapper */
static void __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_5__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_4__dealloc__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_4__dealloc__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0243</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;vv != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0244</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;vv);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0245</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;vg != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0246</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;vg);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0247</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;faceLayer1 != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;faceLayer1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0249</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;faceLayer2 != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0250</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;faceLayer2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0251</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_vertices != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_vertices);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0253</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_normals != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_normals);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_values != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_values);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_faces != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faces</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_faces);
</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0260</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0261</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_increase_size_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell__increase_size_vertices(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  int __pyx_v_newMaxCount;
  float *__pyx_v_newVertices;
  float *__pyx_v_newNormals;
  float *__pyx_v_newValues;
  int __pyx_v_i;
  int __pyx_v_j;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_increase_size_vertices", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0262</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Increase the size of the vertices array by a factor two.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>:         <span class="c"># Allocate new array</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0265</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">newMaxCount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span> <span class="o">*</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_newMaxCount = (__pyx_v_self-&gt;_vertexMaxCount * 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:         <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">newVertices</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">newMaxCount</span><span class="o">*</span><span class="mf">3</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_newVertices = ((float *)malloc(((__pyx_v_newMaxCount * 3) * (sizeof(float)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>:         <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">newNormals</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">newMaxCount</span><span class="o">*</span><span class="mf">3</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_newNormals = ((float *)malloc(((__pyx_v_newMaxCount * 3) * (sizeof(float)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:         <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">newValues</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">newMaxCount</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_newValues = ((float *)malloc((__pyx_v_newMaxCount * (sizeof(float)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>:         <span class="c"># Clear </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0270</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0271</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">,</span> <span class="n">newMaxCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_newMaxCount;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = __pyx_v_self-&gt;_vertexCount; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0272</span>:             <span class="n">newValues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_newValues[__pyx_v_i]) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0273</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0274</span>:                 <span class="n">newNormals</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_newNormals[((__pyx_v_i * 3) + __pyx_v_j)]) = 0.0;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0275</span>:         <span class="c"># Copy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_vertexCount;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:             <span class="n">newValues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_newValues[__pyx_v_i]) = (__pyx_v_self-&gt;_values[__pyx_v_i]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0278</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0279</span>:                 <span class="n">newVertices</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_newVertices[((__pyx_v_i * 3) + __pyx_v_j)]) = (__pyx_v_self-&gt;_vertices[((__pyx_v_i * 3) + __pyx_v_j)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0280</span>:                 <span class="n">newNormals</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_newNormals[((__pyx_v_i * 3) + __pyx_v_j)]) = (__pyx_v_self-&gt;_normals[((__pyx_v_i * 3) + __pyx_v_j)]);
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0281</span>:         <span class="c"># Apply</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span> <span class="o">=</span> <span class="n">newVertices</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;_vertices);
  __pyx_v_self-&gt;_vertices = __pyx_v_newVertices;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0283</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="n">newNormals</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;_normals);
  __pyx_v_self-&gt;_normals = __pyx_v_newNormals;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">newValues</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;_values);
  __pyx_v_self-&gt;_values = __pyx_v_newValues;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span> <span class="o">=</span> <span class="n">newMaxCount</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_vertexMaxCount = __pyx_v_newMaxCount;
</pre><pre class="cython line score-0">&#xA0;<span class="">0286</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_increase_size_faces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell__increase_size_faces(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  int __pyx_v_newMaxCount;
  int *__pyx_v_newFaces;
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_increase_size_faces", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0289</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Increase the size of the faces array by a factor two.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0290</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0291</span>:         <span class="c"># Allocate new array</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">newMaxCount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faceMaxCount</span> <span class="o">*</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_newMaxCount = (__pyx_v_self-&gt;_faceMaxCount * 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:         <span class="k">cdef</span> <span class="kt">int</span> *<span class="nf">newFaces</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">int</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">newMaxCount</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_newFaces = ((int *)malloc((__pyx_v_newMaxCount * (sizeof(int)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0294</span>:         <span class="c"># Copy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0295</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_faceCount;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:             <span class="n">newFaces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_newFaces[__pyx_v_i]) = (__pyx_v_self-&gt;_faces[__pyx_v_i]);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>:         <span class="c"># Apply</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faces</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;_faces);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faces</span> <span class="o">=</span> <span class="n">newFaces</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_faces = __pyx_v_newFaces;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faceMaxCount</span> <span class="o">=</span> <span class="n">newMaxCount</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_faceMaxCount = __pyx_v_newMaxCount;
</pre><pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>:     <span class="c">## Adding results</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0306</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">add_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">float</span> <span class="n">x</span><span class="p">,</span> <span class="nb">float</span> <span class="n">y</span><span class="p">,</span> <span class="nb">float</span> <span class="n">z</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_add_vertex(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, float __pyx_v_x, float __pyx_v_y, float __pyx_v_z) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_vertex", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0307</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a vertex to the result. Return index in vertex array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>:         <span class="c"># Check if array is large enough</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertexMaxCount</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_vertexCount &gt;= __pyx_v_self-&gt;_vertexMaxCount) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0311</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_increase_size_vertices</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_increase_size_vertices(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">0312</span>:         <span class="c"># Add vertex</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0313</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_vertices[((__pyx_v_self-&gt;_vertexCount * 3) + 0)]) = __pyx_v_x;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0314</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_vertices[((__pyx_v_self-&gt;_vertexCount * 3) + 1)]) = __pyx_v_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0315</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_vertices[((__pyx_v_self-&gt;_vertexCount * 3) + 2)]) = __pyx_v_z;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_vertexCount = (__pyx_v_self-&gt;_vertexCount + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;_vertexCount - 1);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0318</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">add_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">vertexIndex</span><span class="p">,</span> <span class="nb">float</span> <span class="n">gx</span><span class="p">,</span> <span class="nb">float</span> <span class="n">gy</span><span class="p">,</span> <span class="nb">float</span> <span class="n">gz</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_add_gradient(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, int __pyx_v_vertexIndex, float __pyx_v_gx, float __pyx_v_gy, float __pyx_v_gz) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_gradient", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0321</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a gradient value to the vertex corresponding to the given index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0322</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0323</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">vertexIndex</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gx</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_vertexIndex * 3) + 0);
  (__pyx_v_self-&gt;_normals[__pyx_t_1]) = ((__pyx_v_self-&gt;_normals[__pyx_t_1]) + __pyx_v_gx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">vertexIndex</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gy</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_vertexIndex * 3) + 1);
  (__pyx_v_self-&gt;_normals[__pyx_t_1]) = ((__pyx_v_self-&gt;_normals[__pyx_t_1]) + __pyx_v_gy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">vertexIndex</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gz</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_vertexIndex * 3) + 2);
  (__pyx_v_self-&gt;_normals[__pyx_t_1]) = ((__pyx_v_self-&gt;_normals[__pyx_t_1]) + __pyx_v_gz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0326</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0328</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">add_gradient_from_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">vertexIndex</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">float</span> <span class="n">strength</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_add_gradient_from_index(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, int __pyx_v_vertexIndex, int __pyx_v_i, float __pyx_v_strength) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_gradient_from_index", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0329</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a gradient value to the vertex corresponding to the given index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: <span class="sd">        vertexIndex is the index in the large array of vertices that is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: <span class="sd">        i is the index of the array of vertices 0-7 for the current cell.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0333</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient</span><span class="p">(</span><span class="n">vertexIndex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">strength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">strength</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">strength</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient(__pyx_v_self, __pyx_v_vertexIndex, ((__pyx_v_self-&gt;vg[((__pyx_v_i * 3) + 0)]) * __pyx_v_strength), ((__pyx_v_self-&gt;vg[((__pyx_v_i * 3) + 1)]) * __pyx_v_strength), ((__pyx_v_self-&gt;vg[((__pyx_v_i * 3) + 2)]) * __pyx_v_strength));
</pre><pre class="cython line score-0">&#xA0;<span class="">0334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0336</span>:     <span class="k">cdef</span> <span class="nf">add_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">index</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>static PyObject *__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_add_face(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_face", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0337</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a face to the result. Also updates the value.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>:         <span class="c"># Check if array is large enough</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0340</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faceMaxCount</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_faceCount &gt;= __pyx_v_self-&gt;_faceMaxCount) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_increase_size_faces</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_increase_size_faces(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">0342</span>:         <span class="c"># Add face</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0343</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faces</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_faces[__pyx_v_self-&gt;_faceCount]) = __pyx_v_index;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0344</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_faceCount = (__pyx_v_self-&gt;_faceCount + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0345</span>:         <span class="c"># Also update value</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0346</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;vmax &gt; (__pyx_v_self-&gt;_values[__pyx_v_index])) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_self-&gt;vmax;
    (__pyx_v_self-&gt;_values[__pyx_v_index]) = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>:     <span class="c">## Getting results</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0352</span>:     <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_7get_vertices(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_6get_vertices[] = " Get the final vertex array.\n        ";
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_7get_vertices(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_vertices (wrapper)", 0);
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_6get_vertices(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_6get_vertices(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  PyObject *__pyx_v_vertices = NULL;
  __Pyx_memviewslice __pyx_v_vertices_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_i;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_vertices", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Cell.get_vertices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertices_, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0353</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the final vertex array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0355</span>:         <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-59 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;_vertexCount);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_vertices = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0356</span>:         <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">vertices_</span> <span class="o">=</span> <span class="n">vertices</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_vertices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  __pyx_v_vertices_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0357</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0358</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;_vertexCount;
  __pyx_t_9 = __pyx_t_6;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0359</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0360</span>:                 <span class="n">vertices_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertices</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices_.data + __pyx_t_12 * __pyx_v_vertices_.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices_.strides[1]) )) = (__pyx_v_self-&gt;_vertices[((__pyx_v_i * 3) + __pyx_v_j)]);
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0361</span>:         <span class="k">return</span> <span class="n">vertices</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  __pyx_r = __pyx_v_vertices;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0362</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:     <span class="k">def</span> <span class="nf">get_normals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_9get_normals(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_8get_normals[] = " Get the final normals array. \n        The normals are normalized to unit length.\n        ";
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_9get_normals(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_normals (wrapper)", 0);
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_8get_normals(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_8get_normals(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  PyObject *__pyx_v_normals = NULL;
  __Pyx_memviewslice __pyx_v_normals_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_length;
  double __pyx_v_dtmp;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_normals", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Cell.get_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_normals);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_normals_, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0364</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the final normals array. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>: <span class="sd">        The normals are normalized to unit length.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0367</span>:         <span class="n">normals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-59 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;_vertexCount);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_normals = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0368</span>:         <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">normals_</span> <span class="o">=</span> <span class="n">normals</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_normals, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  __pyx_v_normals_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0369</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0370</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0371</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">length</span><span class="p">,</span> <span class="nf">dtmp</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0372</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;_vertexCount;
  __pyx_t_9 = __pyx_t_6;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:             <span class="n">length</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_length = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:                 <span class="n">dtmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="c"># Make it double before taking **2!</span></pre>
<pre class='cython code score-0 '>      __pyx_v_dtmp = (__pyx_v_self-&gt;_normals[((__pyx_v_i * 3) + __pyx_v_j)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:                 <span class="n">length</span> <span class="o">+=</span>  <span class="n">dtmp</span><span class="o">*</span><span class="n">dtmp</span></pre>
<pre class='cython code score-0 '>      __pyx_v_length = (__pyx_v_length + (__pyx_v_dtmp * __pyx_v_dtmp));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:             <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = ((__pyx_v_length &gt; 0.0) != 0);
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>:                 <span class="n">length</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">length</span><span class="o">**</span><span class="mf">0.5</span></pre>
<pre class='cython code score-0 '>      __pyx_v_length = (1.0 / pow(__pyx_v_length, 0.5));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0380</span>:                 <span class="n">normals_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">length</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = __pyx_v_j;
      *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_normals_.data + __pyx_t_13 * __pyx_v_normals_.strides[0]) ) + __pyx_t_14 * __pyx_v_normals_.strides[1]) )) = ((__pyx_v_self-&gt;_normals[((__pyx_v_i * 3) + __pyx_v_j)]) * __pyx_v_length);
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:         <span class="k">return</span> <span class="n">normals</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_normals);
  __pyx_r = __pyx_v_normals;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0382</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0383</span>:     <span class="k">def</span> <span class="nf">get_faces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_11get_faces(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_11get_faces(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_faces (wrapper)", 0);
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_10get_faces(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_10get_faces(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  PyObject *__pyx_v_faces = NULL;
  __Pyx_memviewslice __pyx_v_faces_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_faces", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Cell.get_faces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_faces);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_faces_, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:         <span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></pre>
<pre class='cython code score-57 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;_faceCount);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_faces = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0385</span>:         <span class="k">cdef</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">faces_</span> <span class="o">=</span> <span class="n">faces</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_faces, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 385, __pyx_L1_error)</span>
  __pyx_v_faces_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0386</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0387</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_faceCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;_faceCount;
  __pyx_t_9 = __pyx_t_6;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0388</span>:             <span class="n">faces_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    *((int *) ( /* dim=0 */ (__pyx_v_faces_.data + __pyx_t_11 * __pyx_v_faces_.strides[0]) )) = (__pyx_v_self-&gt;_faces[__pyx_v_i]);
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0389</span>:         <span class="k">return</span> <span class="n">faces</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_faces);
  __pyx_r = __pyx_v_faces;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0390</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:     <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_13get_values(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_13get_values(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_values (wrapper)", 0);
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_12get_values(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_12get_values(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  PyObject *__pyx_v_values = NULL;
  __Pyx_memviewslice __pyx_v_values_ = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_values", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Cell.get_values", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_values_, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:         <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-57 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;_vertexCount);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_values = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0393</span>:         <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">values_</span> <span class="o">=</span> <span class="n">values</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_values, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 393, __pyx_L1_error)</span>
  __pyx_v_values_ = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0394</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vertexCount</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;_vertexCount;
  __pyx_t_9 = __pyx_t_6;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0396</span>:             <span class="n">values_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    *((float *) ( /* dim=0 */ (__pyx_v_values_.data + __pyx_t_11 * __pyx_v_values_.strides[0]) )) = (__pyx_v_self-&gt;_values[__pyx_v_i]);
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:         <span class="k">return</span> <span class="n">values</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
  __pyx_r = __pyx_v_values;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0398</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>:     <span class="c">## Called from marching cube function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">new_z_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_new_z_value(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("new_z_value", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0403</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; This method should be called each time a new z layer is entered.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>: <span class="sd">        We will swap the layers with face information and empty the second.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>:         <span class="c"># Swap layers</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;faceLayer2;
  __pyx_t_2 = __pyx_v_self-&gt;faceLayer1;
  __pyx_v_self-&gt;faceLayer1 = __pyx_t_1;
  __pyx_v_self-&gt;faceLayer2 = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0408</span>:         <span class="c"># Empty last</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0410</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">*</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;ny) * 4);
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0411</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;faceLayer2[__pyx_v_i]) = -1;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0412</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0414</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">set_cube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>    <span class="n">double</span> <span class="n">isovalue</span><span class="p">,</span> <span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">,</span> <span class="nb">int</span> <span class="n">z</span><span class="p">,</span> <span class="nb">int</span> <span class="n">step</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_set_cube(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, double __pyx_v_isovalue, int __pyx_v_x, int __pyx_v_y, int __pyx_v_z, int __pyx_v_step, double __pyx_v_v0, double __pyx_v_v1, double __pyx_v_v2, double __pyx_v_v3, double __pyx_v_v4, double __pyx_v_v5, double __pyx_v_v6, double __pyx_v_v7) {
  int __pyx_v_index;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_cube", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0415</span>:                                 <span class="n">double</span> <span class="n">v0</span><span class="p">,</span> <span class="n">double</span> <span class="n">v1</span><span class="p">,</span> <span class="n">double</span> <span class="n">v2</span><span class="p">,</span> <span class="n">double</span> <span class="n">v3</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>:                                 <span class="n">double</span> <span class="n">v4</span><span class="p">,</span> <span class="n">double</span> <span class="n">v5</span><span class="p">,</span> <span class="n">double</span> <span class="n">v6</span><span class="p">,</span> <span class="n">double</span> <span class="n">v7</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the cube to the new location.  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: <span class="sd">        Set the values of the cube corners. The isovalue is subtracted</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span class="sd">        from them, such that in further calculations the isovalue can be </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>: <span class="sd">        taken as zero.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>: <span class="sd">        This method also calculated the magic 256 word to identify the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>: <span class="sd">        cases (i.e. cell.index).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:         <span class="c"># Set location and step</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0428</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;x = __pyx_v_x;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0429</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;y = __pyx_v_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0430</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;z = __pyx_v_z;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0431</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;step = __pyx_v_step;
</pre><pre class="cython line score-0">&#xA0;<span class="">0432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>:         <span class="c"># Set values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v0 = (__pyx_v_v0 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0435</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v1</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v1 = (__pyx_v_v1 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v2</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v2 = (__pyx_v_v2 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v3</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v3 = (__pyx_v_v3 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0438</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v4</span> <span class="o">=</span> <span class="n">v4</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v4 = (__pyx_v_v4 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0439</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v5</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v5 = (__pyx_v_v5 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v6</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v6 = (__pyx_v_v6 - __pyx_v_isovalue);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0441</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v7</span> <span class="o">=</span> <span class="n">v7</span> <span class="o">-</span> <span class="n">isovalue</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v7 = (__pyx_v_v7 - __pyx_v_isovalue);
</pre><pre class="cython line score-0">&#xA0;<span class="">0442</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>:         <span class="c"># Calculate index</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0444</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">index</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_index = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v0 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 1);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v1 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 2);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0447</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v2 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 4);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0448</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">8</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v3 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 8);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v4</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">16</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v4 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 16);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v5</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">32</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v5 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 32);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v6</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">64</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v6 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 64);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v7</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>   <span class="n">index</span> <span class="o">+=</span> <span class="mf">128</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;v7 &gt; 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_v_index = (__pyx_v_index + 0x80);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;index = __pyx_v_index;
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:         <span class="c"># Reset c12</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_calculated</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_calculated = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">add_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lut</span> <span class="n">lut</span><span class="p">,</span> <span class="nb">int</span> <span class="n">lutIndex</span><span class="p">,</span> <span class="nb">int</span> <span class="n">nt</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_add_triangles(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_lut, int __pyx_v_lutIndex, int __pyx_v_nt) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_vi;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_triangles", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0460</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Add triangles.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: <span class="sd">        The vertices for the triangles are specified in the given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: <span class="sd">        Lut at the specified index. There are nt triangles.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: <span class="sd">        The reason that nt should be given is because it is often known</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: <span class="sd">        beforehand.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">vi</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0472</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">prepare_for_adding_triangles</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;prepare_for_adding_triangles(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">0474</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nt;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0477</span>:                 <span class="c"># Get two sides for each element in this vertex</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0478</span>:                 <span class="n">vi</span> <span class="o">=</span> <span class="n">lut</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">lutIndex</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_vi = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_lut-&gt;__pyx_vtab)-&gt;get2(__pyx_v_lut, __pyx_v_lutIndex, ((__pyx_v_i * 3) + __pyx_v_j));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0479</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_add_face_from_edge_index</span><span class="p">(</span><span class="n">vi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_add_face_from_edge_index(__pyx_v_self, __pyx_v_vi);
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0480</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">add_triangles2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Lut</span> <span class="n">lut</span><span class="p">,</span> <span class="nb">int</span> <span class="n">lutIndex</span><span class="p">,</span> <span class="nb">int</span> <span class="n">lutIndex2</span><span class="p">,</span> <span class="nb">int</span> <span class="n">nt</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_add_triangles2(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_lut, int __pyx_v_lutIndex, int __pyx_v_lutIndex2, int __pyx_v_nt) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_vi;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_triangles2", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0483</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Same as add_triangles, except that now the geometry is in a LUT</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>: <span class="sd">        with 3 dimensions, and an extra index is provided.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">vi</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0490</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">prepare_for_adding_triangles</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;prepare_for_adding_triangles(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">0491</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0492</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nt;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0493</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
      __pyx_v_j = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0494</span>:                 <span class="c"># Get two sides for each element in this vertex</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0495</span>:                 <span class="n">vi</span> <span class="o">=</span> <span class="n">lut</span><span class="o">.</span><span class="n">get3</span><span class="p">(</span><span class="n">lutIndex</span><span class="p">,</span> <span class="n">lutIndex2</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="n">j</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_vi = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_lut-&gt;__pyx_vtab)-&gt;get3(__pyx_v_lut, __pyx_v_lutIndex, __pyx_v_lutIndex2, ((__pyx_v_i * 3) + __pyx_v_j));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0496</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_add_face_from_edge_index</span><span class="p">(</span><span class="n">vi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_add_face_from_edge_index(__pyx_v_self, __pyx_v_vi);
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>:     <span class="c">## Used internally</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0500</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_add_face_from_edge_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">vi</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell__add_face_from_edge_index(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, int __pyx_v_vi) {
  int __pyx_v_indexInVertexArray;
  int __pyx_v_indexInFaceLayer;
  int __pyx_v_dx1;
  int __pyx_v_dy1;
  int __pyx_v_dz1;
  int __pyx_v_dx2;
  int __pyx_v_dy2;
  int __pyx_v_dz2;
  int __pyx_v_index1;
  int __pyx_v_index2;
  double __pyx_v_tmpf1;
  double __pyx_v_tmpf2;
  double __pyx_v_fx;
  double __pyx_v_fy;
  double __pyx_v_fz;
  double __pyx_v_ff;
  double __pyx_v_stp;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_add_face_from_edge_index", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Cell._add_face_from_edge_index", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0501</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Add one face from an edge index. Only adds a face if the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>: <span class="sd">        vertex already exists. Otherwise also adds a vertex and applies</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>: <span class="sd">        interpolation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>:         <span class="c"># typedefs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">indexInVertexArray</span><span class="p">,</span> <span class="nf">indexInFaceLayer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dx1</span><span class="p">,</span> <span class="nf">dy1</span><span class="p">,</span> <span class="nf">dz1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">dx2</span><span class="p">,</span> <span class="nf">dy2</span><span class="p">,</span> <span class="nf">dz2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">index1</span><span class="p">,</span> <span class="nf">index2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">tmpf1</span><span class="p">,</span> <span class="nf">tmpf2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">fx</span><span class="p">,</span> <span class="nf">fy</span><span class="p">,</span> <span class="nf">fz</span><span class="p">,</span> <span class="nf">ff</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0513</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">stp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>  __pyx_v_stp = ((double)__pyx_v_self-&gt;step);
</pre><pre class="cython line score-0">&#xA0;<span class="">0514</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>:         <span class="c"># Get index in the face layer and corresponding vertex number</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0516</span>:         <span class="n">indexInFaceLayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index_in_facelayer</span><span class="p">(</span><span class="n">vi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indexInFaceLayer = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;get_index_in_facelayer(__pyx_v_self, __pyx_v_vi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0517</span>:         <span class="n">indexInVertexArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer</span><span class="p">[</span><span class="n">indexInFaceLayer</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indexInVertexArray = (__pyx_v_self-&gt;faceLayer[__pyx_v_indexInFaceLayer]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0518</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>:         <span class="c"># If we have the center vertex, we have things pre-calculated,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>:         <span class="c"># otherwise we need to interpolate.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>:         <span class="c"># In both cases we distinguish between having this vertex already</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0522</span>:         <span class="c"># or not.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:         <span class="k">if</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">12</span><span class="p">:</span> <span class="c"># center vertex</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_vi == 12) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_calculated</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_self-&gt;v12_calculated == 0) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">calculate_center_vertex</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;calculate_center_vertex(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:             <span class="k">if</span> <span class="n">indexInVertexArray</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_indexInVertexArray &gt;= 0) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0528</span>:                 <span class="c"># Vertex already calculated, only need to add face and gradient</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>      __pyx_t_2 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_face(__pyx_v_self, __pyx_v_indexInVertexArray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0530</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_xg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_yg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_zg</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient(__pyx_v_self, __pyx_v_indexInVertexArray, __pyx_v_self-&gt;v12_xg, __pyx_v_self-&gt;v12_yg, __pyx_v_self-&gt;v12_zg);
</pre><pre class="cython line score-0">&#xA0;<span class="">0531</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>:                 <span class="c"># Add precalculated center vertex position (is interpolated)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0533</span>:                 <span class="n">indexInVertexArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_indexInVertexArray = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_vertex(__pyx_v_self, __pyx_v_self-&gt;v12_x, __pyx_v_self-&gt;v12_y, __pyx_v_self-&gt;v12_z);
</pre><pre class="cython line score-0">&#xA0;<span class="">0534</span>:                 <span class="c"># Update face layer</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0535</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer</span><span class="p">[</span><span class="n">indexInFaceLayer</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexInVertexArray</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_self-&gt;faceLayer[__pyx_v_indexInFaceLayer]) = __pyx_v_indexInVertexArray;
</pre><pre class="cython line score-0">&#xA0;<span class="">0536</span>:                 <span class="c"># Add face and gradient</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0537</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>      __pyx_t_2 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_face(__pyx_v_self, __pyx_v_indexInVertexArray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 537, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0538</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_xg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_yg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v12_zg</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient(__pyx_v_self, __pyx_v_indexInVertexArray, __pyx_v_self-&gt;v12_xg, __pyx_v_self-&gt;v12_yg, __pyx_v_self-&gt;v12_zg);
    }
    __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0539</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>:             <span class="c"># Get relative edge indices for x, y and z</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0543</span>:             <span class="n">dx1</span><span class="p">,</span> <span class="n">dx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">luts</span><span class="o">.</span><span class="n">EDGESRELX</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">luts</span><span class="o">.</span><span class="n">EDGESRELX</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_3 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self-&gt;luts-&gt;EDGESRELX-&gt;__pyx_vtab)-&gt;get2(__pyx_v_self-&gt;luts-&gt;EDGESRELX, __pyx_v_vi, 0);
    __pyx_t_4 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self-&gt;luts-&gt;EDGESRELX-&gt;__pyx_vtab)-&gt;get2(__pyx_v_self-&gt;luts-&gt;EDGESRELX, __pyx_v_vi, 1);
    __pyx_v_dx1 = __pyx_t_3;
    __pyx_v_dx2 = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0544</span>:             <span class="n">dy1</span><span class="p">,</span> <span class="n">dy2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">luts</span><span class="o">.</span><span class="n">EDGESRELY</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">luts</span><span class="o">.</span><span class="n">EDGESRELY</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self-&gt;luts-&gt;EDGESRELY-&gt;__pyx_vtab)-&gt;get2(__pyx_v_self-&gt;luts-&gt;EDGESRELY, __pyx_v_vi, 0);
    __pyx_t_3 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self-&gt;luts-&gt;EDGESRELY-&gt;__pyx_vtab)-&gt;get2(__pyx_v_self-&gt;luts-&gt;EDGESRELY, __pyx_v_vi, 1);
    __pyx_v_dy1 = __pyx_t_4;
    __pyx_v_dy2 = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0545</span>:             <span class="n">dz1</span><span class="p">,</span> <span class="n">dz2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">luts</span><span class="o">.</span><span class="n">EDGESRELZ</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="mf">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">luts</span><span class="o">.</span><span class="n">EDGESRELZ</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self-&gt;luts-&gt;EDGESRELZ-&gt;__pyx_vtab)-&gt;get2(__pyx_v_self-&gt;luts-&gt;EDGESRELZ, __pyx_v_vi, 0);
    __pyx_t_4 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self-&gt;luts-&gt;EDGESRELZ-&gt;__pyx_vtab)-&gt;get2(__pyx_v_self-&gt;luts-&gt;EDGESRELZ, __pyx_v_vi, 1);
    __pyx_v_dz1 = __pyx_t_3;
    __pyx_v_dz2 = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0546</span>:             <span class="c"># Make two vertex indices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0547</span>:             <span class="n">index1</span> <span class="o">=</span> <span class="n">dz1</span><span class="o">*</span><span class="mf">4</span> <span class="o">+</span> <span class="n">dy1</span><span class="o">*</span><span class="mf">2</span> <span class="o">+</span> <span class="n">dx1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_index1 = (((__pyx_v_dz1 * 4) + (__pyx_v_dy1 * 2)) + __pyx_v_dx1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0548</span>:             <span class="n">index2</span> <span class="o">=</span> <span class="n">dz2</span><span class="o">*</span><span class="mf">4</span> <span class="o">+</span> <span class="n">dy2</span><span class="o">*</span><span class="mf">2</span> <span class="o">+</span> <span class="n">dx2</span></pre>
<pre class='cython code score-0 '>    __pyx_v_index2 = (((__pyx_v_dz2 * 4) + (__pyx_v_dy2 * 2)) + __pyx_v_dx2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0549</span>:             <span class="c"># Define strength of both corners</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0550</span>:             <span class="n">tmpf1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">index1</span><span class="p">]))</span></pre>
<pre class='cython code score-0 '>    __pyx_v_tmpf1 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs((__pyx_v_self-&gt;vv[__pyx_v_index1]))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0551</span>:             <span class="n">tmpf2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">index2</span><span class="p">]))</span></pre>
<pre class='cython code score-0 '>    __pyx_v_tmpf2 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs((__pyx_v_self-&gt;vv[__pyx_v_index2]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0552</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>:             <span class="c"># print(&#39;indexInVertexArray&#39;, self.x, self.y, self.z, &#39;-&#39;, vi, indexInVertexArray, indexInFaceLayer)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0555</span>:             <span class="k">if</span> <span class="n">indexInVertexArray</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_indexInVertexArray &gt;= 0) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0556</span>:                 <span class="c"># Vertex already calculated, only need to add face and gradient</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0557</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>      __pyx_t_2 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_face(__pyx_v_self, __pyx_v_indexInVertexArray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0558</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient_from_index</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">,</span> <span class="n">index1</span><span class="p">,</span> <span class="n">tmpf1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient_from_index(__pyx_v_self, __pyx_v_indexInVertexArray, __pyx_v_index1, __pyx_v_tmpf1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0559</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient_from_index</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">,</span> <span class="n">index2</span><span class="p">,</span> <span class="n">tmpf2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient_from_index(__pyx_v_self, __pyx_v_indexInVertexArray, __pyx_v_index2, __pyx_v_tmpf2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0560</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>:                 <span class="c"># Interpolate by applying a kind of center-of-mass method</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0563</span>:                 <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">ff</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_5 = 0.0;
      __pyx_t_6 = 0.0;
      __pyx_t_7 = 0.0;
      __pyx_t_8 = 0.0;
      __pyx_v_fx = __pyx_t_5;
      __pyx_v_fy = __pyx_t_6;
      __pyx_v_fz = __pyx_t_7;
      __pyx_v_ff = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0564</span>:                 <span class="n">fx</span> <span class="o">+=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="n">dx1</span> <span class="o">*</span> <span class="n">tmpf1</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="n">dy1</span> <span class="o">*</span> <span class="n">tmpf1</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="n">dz1</span> <span class="o">*</span> <span class="n">tmpf1</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">tmpf1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_fx = (__pyx_v_fx + (((double)__pyx_v_dx1) * __pyx_v_tmpf1));
      __pyx_v_fy = (__pyx_v_fy + (((double)__pyx_v_dy1) * __pyx_v_tmpf1));
      __pyx_v_fz = (__pyx_v_fz + (((double)__pyx_v_dz1) * __pyx_v_tmpf1));
      __pyx_v_ff = (__pyx_v_ff + __pyx_v_tmpf1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0565</span>:                 <span class="n">fx</span> <span class="o">+=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="n">dx2</span> <span class="o">*</span> <span class="n">tmpf2</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="n">dy2</span> <span class="o">*</span> <span class="n">tmpf2</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="n">dz2</span> <span class="o">*</span> <span class="n">tmpf2</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">tmpf2</span></pre>
<pre class='cython code score-0 '>      __pyx_v_fx = (__pyx_v_fx + (((double)__pyx_v_dx2) * __pyx_v_tmpf2));
      __pyx_v_fy = (__pyx_v_fy + (((double)__pyx_v_dy2) * __pyx_v_tmpf2));
      __pyx_v_fz = (__pyx_v_fz + (((double)__pyx_v_dz2) * __pyx_v_tmpf2));
      __pyx_v_ff = (__pyx_v_ff + __pyx_v_tmpf2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0566</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>:                 <span class="c"># Add vertex</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0568</span>:                 <span class="n">indexInVertexArray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>      __pyx_v_indexInVertexArray = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_vertex(__pyx_v_self, (((double)__pyx_v_self-&gt;x) + ((__pyx_v_stp * __pyx_v_fx) / __pyx_v_ff)), (((double)__pyx_v_self-&gt;y) + ((__pyx_v_stp * __pyx_v_fy) / __pyx_v_ff)), (((double)__pyx_v_self-&gt;z) + ((__pyx_v_stp * __pyx_v_fz) / __pyx_v_ff)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0569</span>:                                 <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">stp</span><span class="o">*</span><span class="n">fx</span><span class="o">/</span><span class="n">ff</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>:                                 <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">stp</span><span class="o">*</span><span class="n">fy</span><span class="o">/</span><span class="n">ff</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:                                 <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">stp</span><span class="o">*</span><span class="n">fz</span><span class="o">/</span><span class="n">ff</span> <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>:                 <span class="c"># Update face layer</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer</span><span class="p">[</span><span class="n">indexInFaceLayer</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexInVertexArray</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_self-&gt;faceLayer[__pyx_v_indexInFaceLayer]) = __pyx_v_indexInVertexArray;
</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>:                 <span class="c"># Add face and gradient</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>      __pyx_t_2 = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_face(__pyx_v_self, __pyx_v_indexInVertexArray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0576</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient_from_index</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">,</span> <span class="n">index1</span><span class="p">,</span> <span class="n">tmpf1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient_from_index(__pyx_v_self, __pyx_v_indexInVertexArray, __pyx_v_index1, __pyx_v_tmpf1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0577</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">add_gradient_from_index</span><span class="p">(</span><span class="n">indexInVertexArray</span><span class="p">,</span> <span class="n">index2</span><span class="p">,</span> <span class="n">tmpf2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_self-&gt;__pyx_vtab)-&gt;add_gradient_from_index(__pyx_v_self, __pyx_v_indexInVertexArray, __pyx_v_index2, __pyx_v_tmpf2);
    }
    __pyx_L6:;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0578</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="c">#         # Create vertex non-interpolated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>: <span class="c">#         self.add_vertex( self.x + 0.5* dx1 + 0.5 * dx2,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="c">#                         self.y + 0.5* dy1 + 0.5 * dy2,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: <span class="c">#                         self.z + 0.5* dz1 + 0.5 * dz2 )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0587</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">get_index_in_facelayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">vi</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_get_index_in_facelayer(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self, int __pyx_v_vi) {
  int __pyx_v_i;
  int __pyx_v_j;
  CYTHON_UNUSED int __pyx_v_vi_;
  int *__pyx_v_faceLayer;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_index_in_facelayer", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0588</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: <span class="sd">        Get the index of a vertex position, given the edge on which it lies.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: <span class="sd">        We keep a list of faces so we can reuse vertices. This improves</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: <span class="sd">        speed because we need less interpolation, and the result is more</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>: <span class="sd">        compact and can be visualized better because normals can be </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: <span class="sd">        interpolated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>: <span class="sd">        For each cell, we store 4 vertex indices; all other edges can be </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>: <span class="sd">        represented as the edge of another cell.  The fourth is the center vertex.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>: <span class="sd">        This method returns -1 if no vertex has been defined yet.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>: <span class="sd">              vertices              edges                edge-indices per cell</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>: <span class="sd">        *         7 ________ 6           _____6__             ________</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>: <span class="sd">        *         /|       /|         7/|       /|          /|       /|</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>: <span class="sd">        *       /  |     /  |        /  |     /5 |        /  |     /  |</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0605</span>: <span class="sd">        *   4 /_______ /    |      /__4____ /    10     /_______ /    |</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>: <span class="sd">        *    |     |  |5    |     |    11  |     |     |     |  |     |</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>: <span class="sd">        *    |    3|__|_____|2    |     |__|__2__|     |     |__|_____|</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>: <span class="sd">        *    |    /   |    /      8   3/   9    /      2    /   |    /</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>: <span class="sd">        *    |  /     |  /        |  /     |  /1       |  1     |  /</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>: <span class="sd">        *    |/_______|/          |/___0___|/          |/___0___|/</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>: <span class="sd">        *   0          1                 </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>: <span class="sd">        */</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0614</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>:         <span class="c"># Init indices, both are corrected below</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>  <span class="c"># Index of cube to get vertex at</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = ((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;y) + __pyx_v_self-&gt;x);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0617</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">j</span> <span class="o">=</span> <span class="mf">0</span> <span class="c"># Vertex number for that cell</span></pre>
<pre class='cython code score-0 '>  __pyx_v_j = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">vi_</span> <span class="o">=</span> <span class="n">vi</span></pre>
<pre class='cython code score-0 '>  __pyx_v_vi_ = __pyx_v_vi;
</pre><pre class="cython line score-0">&#xA0;<span class="">0619</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>:         <span class="k">cdef</span> <span class="kt">int</span> *<span class="nf">faceLayer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>:         <span class="c"># Select either upper or lower half</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0623</span>:         <span class="k">if</span> <span class="n">vi</span> <span class="o">&lt;</span> <span class="mf">8</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_vi &lt; 8) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0624</span>:             <span class="c">#  8 horizontal edges</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:             <span class="k">if</span> <span class="n">vi</span> <span class="o">&lt;</span> <span class="mf">4</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_vi &lt; 4) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:                 <span class="n">faceLayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_self-&gt;faceLayer1;
      __pyx_v_faceLayer = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0627</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:                 <span class="n">vi</span> <span class="o">-=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_vi = (__pyx_v_vi - 4);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:                 <span class="n">faceLayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer2</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_self-&gt;faceLayer2;
      __pyx_v_faceLayer = __pyx_t_2;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0630</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0631</span>:             <span class="c"># Calculate actual index based on edge </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0632</span>:             <span class="c">#if vi == 0: pass  # no step</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0633</span>:             <span class="k">if</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span>  <span class="c"># step in x</span></pre>
<pre class='cython code score-0 '>    switch (__pyx_v_vi) {
      case 1:
/* … */
      break;
      case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0634</span>:                 <span class="n">i</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + __pyx_v_self-&gt;step);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:             <span class="k">elif</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span>  <span class="c"># step in y</span></pre>
<pre class='cython code score-0 '>      break;
      case 3:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:                 <span class="n">i</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + (__pyx_v_self-&gt;nx * __pyx_v_self-&gt;step));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:             <span class="k">elif</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span>  <span class="c"># no step</span></pre>
<pre class='cython code score-0 '>      break;
      default: break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0640</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0641</span>:         <span class="k">elif</span> <span class="n">vi</span> <span class="o">&lt;</span> <span class="mf">12</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_vi &lt; 12) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0642</span>:             <span class="c"># 4 vertical edges</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0643</span>:             <span class="n">faceLayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_self-&gt;faceLayer1;
    __pyx_v_faceLayer = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>:             <span class="n">j</span> <span class="o">=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_v_j = 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0645</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>:             <span class="c">#if vi == 8: pass # no step</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>:             <span class="k">if</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">9</span><span class="p">:</span>   <span class="c"># step in x</span></pre>
<pre class='cython code score-0 '>    switch (__pyx_v_vi) {
      case 9:
/* … */
      break;
      case 10:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0648</span>:                 <span class="n">i</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + __pyx_v_self-&gt;step);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0649</span>:             <span class="k">elif</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">10</span><span class="p">:</span>   <span class="c"># step in x and y</span></pre>
<pre class='cython code score-0 '>      break;
      case 11:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:                 <span class="n">i</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + ((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;step) + __pyx_v_self-&gt;step));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0651</span>:             <span class="k">elif</span> <span class="n">vi</span> <span class="o">==</span> <span class="mf">11</span><span class="p">:</span>  <span class="c"># step in y</span></pre>
<pre class='cython code score-0 '>      break;
      default: break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0652</span>:                 <span class="n">i</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + (__pyx_v_self-&gt;nx * __pyx_v_self-&gt;step));
</pre><pre class="cython line score-0">&#xA0;<span class="">0653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:             <span class="c"># center vertex</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0656</span>:             <span class="n">faceLayer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer1</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_2 = __pyx_v_self-&gt;faceLayer1;
    __pyx_v_faceLayer = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0657</span>:             <span class="n">j</span> <span class="o">=</span> <span class="mf">3</span></pre>
<pre class='cython code score-0 '>    __pyx_v_j = 3;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>:         <span class="c"># Store facelayer and return index</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">faceLayer</span> <span class="o">=</span> <span class="n">faceLayer</span> <span class="c"># Dirty way of returning a value</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;faceLayer = __pyx_v_faceLayer;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:         <span class="k">return</span> <span class="mf">4</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((4 * __pyx_v_i) + __pyx_v_j);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0662</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0663</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">prepare_for_adding_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_prepare_for_adding_triangles(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  int __pyx_v_i;
  double __pyx_v_vmin;
  double __pyx_v_vmax;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prepare_for_adding_triangles", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0665</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculates some things to help adding the triangles:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>: <span class="sd">        array with corner values, max corner value, gradient at each corner.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0669</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0670</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0671</span>:         <span class="c"># Copy values in array so we can index them. Note the misalignment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>:         <span class="c"># because the numbering does not correspond with bitwise OR of xyz.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v0;
  (__pyx_v_self-&gt;vv[0]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0674</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v1;
  (__pyx_v_self-&gt;vv[1]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0675</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="c">#</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v3;
  (__pyx_v_self-&gt;vv[2]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0676</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="c">#</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v2;
  (__pyx_v_self-&gt;vv[3]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0677</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v4</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v4;
  (__pyx_v_self-&gt;vv[4]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v5</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v5;
  (__pyx_v_self-&gt;vv[5]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v7</span><span class="c">#</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v7;
  (__pyx_v_self-&gt;vv[6]) = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0680</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v6</span><span class="c">#</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;v6;
  (__pyx_v_self-&gt;vv[7]) = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0681</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>:         <span class="c"># Calculate max</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">vmin</span><span class="p">,</span> <span class="nf">vmax</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>:         <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0.0;
  __pyx_t_2 = 0.0;
  __pyx_v_vmin = __pyx_t_1;
  __pyx_v_vmax = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0685</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_3 = 0; __pyx_t_3 &lt; 8; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (((__pyx_v_self-&gt;vv[__pyx_v_i]) &gt; __pyx_v_vmax) != 0);
    if (__pyx_t_4) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>:                 <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_vmax = (__pyx_v_self-&gt;vv[__pyx_v_i]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0688</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">vmin</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (((__pyx_v_self-&gt;vv[__pyx_v_i]) &lt; __pyx_v_vmin) != 0);
    if (__pyx_t_4) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0689</span>:                 <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_vmin = (__pyx_v_self-&gt;vv[__pyx_v_i]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;vmax = (__pyx_v_vmax - __pyx_v_vmin);
</pre><pre class="cython line score-0">&#xA0;<span class="">0691</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0692</span>:         <span class="c"># Calculate gradients</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0693</span>:         <span class="c"># Derivatives, selected to always point in same direction.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0694</span>:         <span class="c"># Note that many corners have the same components as other points,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0695</span>:         <span class="c"># by interpolating  and averaging the normals this is solved.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0696</span>:         <span class="c"># todo: we can potentially reuse these similar to how we store vertex indices in face layers</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">0</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">0</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">0</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v4</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;v0 - __pyx_v_self-&gt;v1);
  __pyx_t_1 = (__pyx_v_self-&gt;v0 - __pyx_v_self-&gt;v3);
  __pyx_t_5 = (__pyx_v_self-&gt;v0 - __pyx_v_self-&gt;v4);
  (__pyx_v_self-&gt;vg[0]) = __pyx_t_2;
  (__pyx_v_self-&gt;vg[1]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[2]) = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">1</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">1</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">1</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v5</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;v0 - __pyx_v_self-&gt;v1);
  __pyx_t_1 = (__pyx_v_self-&gt;v1 - __pyx_v_self-&gt;v2);
  __pyx_t_2 = (__pyx_v_self-&gt;v1 - __pyx_v_self-&gt;v5);
  (__pyx_v_self-&gt;vg[3]) = __pyx_t_5;
  (__pyx_v_self-&gt;vg[4]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[5]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0699</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;v3 - __pyx_v_self-&gt;v2);
  __pyx_t_1 = (__pyx_v_self-&gt;v1 - __pyx_v_self-&gt;v2);
  __pyx_t_5 = (__pyx_v_self-&gt;v2 - __pyx_v_self-&gt;v6);
  (__pyx_v_self-&gt;vg[6]) = __pyx_t_2;
  (__pyx_v_self-&gt;vg[7]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[8]) = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v7</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;v3 - __pyx_v_self-&gt;v2);
  __pyx_t_1 = (__pyx_v_self-&gt;v0 - __pyx_v_self-&gt;v3);
  __pyx_t_2 = (__pyx_v_self-&gt;v3 - __pyx_v_self-&gt;v7);
  (__pyx_v_self-&gt;vg[9]) = __pyx_t_5;
  (__pyx_v_self-&gt;vg[10]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[11]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">4</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">4</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">4</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v4</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v4</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v7</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v4</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;v4 - __pyx_v_self-&gt;v5);
  __pyx_t_1 = (__pyx_v_self-&gt;v4 - __pyx_v_self-&gt;v7);
  __pyx_t_5 = (__pyx_v_self-&gt;v0 - __pyx_v_self-&gt;v4);
  (__pyx_v_self-&gt;vg[12]) = __pyx_t_2;
  (__pyx_v_self-&gt;vg[13]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[14]) = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">5</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">5</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">5</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v4</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v5</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v5</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;v4 - __pyx_v_self-&gt;v5);
  __pyx_t_1 = (__pyx_v_self-&gt;v5 - __pyx_v_self-&gt;v6);
  __pyx_t_2 = (__pyx_v_self-&gt;v1 - __pyx_v_self-&gt;v5);
  (__pyx_v_self-&gt;vg[15]) = __pyx_t_5;
  (__pyx_v_self-&gt;vg[16]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[17]) = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0703</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">6</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">6</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">6</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v7</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v5</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;v7 - __pyx_v_self-&gt;v6);
  __pyx_t_1 = (__pyx_v_self-&gt;v5 - __pyx_v_self-&gt;v6);
  __pyx_t_5 = (__pyx_v_self-&gt;v2 - __pyx_v_self-&gt;v6);
  (__pyx_v_self-&gt;vg[18]) = __pyx_t_2;
  (__pyx_v_self-&gt;vg[19]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[20]) = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0704</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">7</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">7</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">7</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v7</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v4</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v7</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v7</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;v7 - __pyx_v_self-&gt;v6);
  __pyx_t_1 = (__pyx_v_self-&gt;v4 - __pyx_v_self-&gt;v7);
  __pyx_t_2 = (__pyx_v_self-&gt;v3 - __pyx_v_self-&gt;v7);
  (__pyx_v_self-&gt;vg[21]) = __pyx_t_5;
  (__pyx_v_self-&gt;vg[22]) = __pyx_t_1;
  (__pyx_v_self-&gt;vg[23]) = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0705</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0707</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">calculate_center_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_4Cell_calculate_center_vertex(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_self) {
  double __pyx_v_v0;
  double __pyx_v_v1;
  double __pyx_v_v2;
  double __pyx_v_v3;
  double __pyx_v_v4;
  double __pyx_v_v5;
  double __pyx_v_v6;
  double __pyx_v_v7;
  double __pyx_v_fx;
  double __pyx_v_fy;
  double __pyx_v_fz;
  double __pyx_v_ff;
  double __pyx_v_stp;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_center_vertex", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0708</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculate interpolated center vertex and its gradient.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">v0</span><span class="p">,</span> <span class="nf">v1</span><span class="p">,</span> <span class="nf">v2</span><span class="p">,</span> <span class="nf">v3</span><span class="p">,</span> <span class="nf">v4</span><span class="p">,</span> <span class="nf">v5</span><span class="p">,</span> <span class="nf">v6</span><span class="p">,</span> <span class="nf">v7</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">fx</span><span class="p">,</span> <span class="nf">fy</span><span class="p">,</span> <span class="nf">fz</span><span class="p">,</span> <span class="nf">ff</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:         <span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">ff</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0.0;
  __pyx_t_2 = 0.0;
  __pyx_t_3 = 0.0;
  __pyx_t_4 = 0.0;
  __pyx_v_fx = __pyx_t_1;
  __pyx_v_fy = __pyx_t_2;
  __pyx_v_fz = __pyx_t_3;
  __pyx_v_ff = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0713</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>:         <span class="c"># Define &quot;strength&quot; of each corner of the cube that we need</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0715</span>:         <span class="n">v0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v0 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v0)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0716</span>:         <span class="n">v1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v1</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v1 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0717</span>:         <span class="n">v2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v2 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v2)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0718</span>:         <span class="n">v3</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v3</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v3 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v3)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0719</span>:         <span class="n">v4</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v4</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v4 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v4)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0720</span>:         <span class="n">v5</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v5</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v5 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v5)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0721</span>:         <span class="n">v6</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v6</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v6 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v6)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0722</span>:         <span class="n">v7</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FLT_EPSILON</span> <span class="o">+</span> <span class="n">dabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v7</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v7 = (1.0 / (__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON + __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_dabs(__pyx_v_self-&gt;v7)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>:         <span class="c"># Apply a kind of center-of-mass method</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0725</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v0</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v0</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v0</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (0.0 * __pyx_v_v0));
  __pyx_v_fy = (__pyx_v_fy + (0.0 * __pyx_v_v0));
  __pyx_v_fz = (__pyx_v_fz + (0.0 * __pyx_v_v0));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0726</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v1</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v1</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v1</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (1.0 * __pyx_v_v1));
  __pyx_v_fy = (__pyx_v_fy + (0.0 * __pyx_v_v1));
  __pyx_v_fz = (__pyx_v_fz + (0.0 * __pyx_v_v1));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0727</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v2</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v2</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v2</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (1.0 * __pyx_v_v2));
  __pyx_v_fy = (__pyx_v_fy + (1.0 * __pyx_v_v2));
  __pyx_v_fz = (__pyx_v_fz + (0.0 * __pyx_v_v2));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0728</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v3</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v3</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v3</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v3</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (0.0 * __pyx_v_v3));
  __pyx_v_fy = (__pyx_v_fy + (1.0 * __pyx_v_v3));
  __pyx_v_fz = (__pyx_v_fz + (0.0 * __pyx_v_v3));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v3);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0729</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v4</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v4</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v4</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v4</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (0.0 * __pyx_v_v4));
  __pyx_v_fy = (__pyx_v_fy + (0.0 * __pyx_v_v4));
  __pyx_v_fz = (__pyx_v_fz + (1.0 * __pyx_v_v4));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v4);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v5</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v5</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v5</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v5</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (1.0 * __pyx_v_v5));
  __pyx_v_fy = (__pyx_v_fy + (0.0 * __pyx_v_v5));
  __pyx_v_fz = (__pyx_v_fz + (1.0 * __pyx_v_v5));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v5);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0731</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v6</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v6</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v6</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v6</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (1.0 * __pyx_v_v6));
  __pyx_v_fy = (__pyx_v_fy + (1.0 * __pyx_v_v6));
  __pyx_v_fz = (__pyx_v_fz + (1.0 * __pyx_v_v6));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v6);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0732</span>:         <span class="n">fx</span> <span class="o">+=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">v7</span><span class="p">;</span>  <span class="n">fy</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v7</span><span class="p">;</span>  <span class="n">fz</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">v7</span><span class="p">;</span>  <span class="n">ff</span> <span class="o">+=</span> <span class="n">v7</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fx = (__pyx_v_fx + (0.0 * __pyx_v_v7));
  __pyx_v_fy = (__pyx_v_fy + (1.0 * __pyx_v_v7));
  __pyx_v_fz = (__pyx_v_fz + (1.0 * __pyx_v_v7));
  __pyx_v_ff = (__pyx_v_ff + __pyx_v_v7);
</pre><pre class="cython line score-0">&#xA0;<span class="">0733</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>:         <span class="c"># Store</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0735</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">stp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span></pre>
<pre class='cython code score-0 '>  __pyx_v_stp = ((double)__pyx_v_self-&gt;step);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">stp</span> <span class="o">*</span> <span class="n">fx</span> <span class="o">/</span> <span class="n">ff</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_x = (__pyx_v_self-&gt;x + ((__pyx_v_stp * __pyx_v_fx) / __pyx_v_ff));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0737</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">stp</span> <span class="o">*</span> <span class="n">fy</span> <span class="o">/</span> <span class="n">ff</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_y = (__pyx_v_self-&gt;y + ((__pyx_v_stp * __pyx_v_fy) / __pyx_v_ff));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">stp</span> <span class="o">*</span> <span class="n">fz</span> <span class="o">/</span> <span class="n">ff</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_z = (__pyx_v_self-&gt;z + ((__pyx_v_stp * __pyx_v_fz) / __pyx_v_ff));
</pre><pre class="cython line score-0">&#xA0;<span class="">0739</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>:         <span class="c"># Also pre-calculate gradient of center</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>:         <span class="c"># note that prepare_for_adding_triangles() must have been called for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>:         <span class="c"># the gradient data to exist. </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_xg</span> <span class="o">=</span> <span class="p">(</span> <span class="n">v0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">0</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">1</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_xg = ((((((((__pyx_v_v0 * (__pyx_v_self-&gt;vg[0])) + (__pyx_v_v1 * (__pyx_v_self-&gt;vg[3]))) + (__pyx_v_v2 * (__pyx_v_self-&gt;vg[6]))) + (__pyx_v_v3 * (__pyx_v_self-&gt;vg[9]))) + (__pyx_v_v4 * (__pyx_v_self-&gt;vg[12]))) + (__pyx_v_v5 * (__pyx_v_self-&gt;vg[15]))) + (__pyx_v_v6 * (__pyx_v_self-&gt;vg[18]))) + (__pyx_v_v7 * (__pyx_v_self-&gt;vg[21])));
</pre><pre class="cython line score-0">&#xA0;<span class="">0744</span>:                         <span class="n">v4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">4</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">5</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">6</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v7</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">7</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">0</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_yg</span> <span class="o">=</span> <span class="p">(</span> <span class="n">v0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">0</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">1</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_yg = ((((((((__pyx_v_v0 * (__pyx_v_self-&gt;vg[1])) + (__pyx_v_v1 * (__pyx_v_self-&gt;vg[4]))) + (__pyx_v_v2 * (__pyx_v_self-&gt;vg[7]))) + (__pyx_v_v3 * (__pyx_v_self-&gt;vg[10]))) + (__pyx_v_v4 * (__pyx_v_self-&gt;vg[13]))) + (__pyx_v_v5 * (__pyx_v_self-&gt;vg[16]))) + (__pyx_v_v6 * (__pyx_v_self-&gt;vg[19]))) + (__pyx_v_v7 * (__pyx_v_self-&gt;vg[22])));
</pre><pre class="cython line score-0">&#xA0;<span class="">0746</span>:                         <span class="n">v4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">4</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">5</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">6</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v7</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">7</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0747</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_xg</span> <span class="o">=</span> <span class="p">(</span> <span class="n">v0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">0</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">1</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">2</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_xg = ((((((((__pyx_v_v0 * (__pyx_v_self-&gt;vg[2])) + (__pyx_v_v1 * (__pyx_v_self-&gt;vg[5]))) + (__pyx_v_v2 * (__pyx_v_self-&gt;vg[8]))) + (__pyx_v_v3 * (__pyx_v_self-&gt;vg[11]))) + (__pyx_v_v4 * (__pyx_v_self-&gt;vg[14]))) + (__pyx_v_v5 * (__pyx_v_self-&gt;vg[17]))) + (__pyx_v_v6 * (__pyx_v_self-&gt;vg[20]))) + (__pyx_v_v7 * (__pyx_v_self-&gt;vg[23])));
</pre><pre class="cython line score-0">&#xA0;<span class="">0748</span>:                         <span class="n">v4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">4</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">5</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">6</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v7</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">vg</span><span class="p">[</span><span class="mf">7</span><span class="o">*</span><span class="mf">3</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>:         <span class="c"># Set flag that this stuff is calculated</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0751</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">v12_calculated</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;v12_calculated = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0752</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0755</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Lut</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut {
  PyObject_HEAD
  struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_vtab;
  char *VALUES;
  int L0;
  int L1;
  int L2;
};
/* … */
struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut {
  int (*get1)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *, int);
  int (*get2)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *, int, int);
  int (*get3)(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *, int, int, int);
};
static struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_vtabptr_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut;

</pre><pre class="cython line score-0">&#xA0;<span class="">0756</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; Representation of a lookup table.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>: <span class="sd">    The tables are initially defined as numpy arrays. On initialization,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>: <span class="sd">    this class converts them to a C array for fast access.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>: <span class="sd">    This class defines functions to look up values using 1, 2 or 3 indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>:     <span class="k">cdef</span> <span class="kt">char</span>* <span class="nf">VALUES</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">L0</span> <span class="c"># Length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">L1</span> <span class="c"># size of tuple</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">L2</span> <span class="c"># size of tuple in tuple (if any)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0766</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span></pre>
<pre class='cython code score-25 '>/* Python wrapper */
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_array = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_array,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 767, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_array = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 767, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Lut.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut___init__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self), __pyx_v_array);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut___init__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_self, PyObject *__pyx_v_array) {
  int __pyx_v_n;
  int __pyx_v_N;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_array);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.Lut.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_array);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0768</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0769</span>:         <span class="c"># Get the shape of the LUT</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">L1</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;L1 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;L2 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0772</span>:         <span class="c">#</span></pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">L0</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self-&gt;L0 = __pyx_t_3;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:         <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_int_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0775</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">L1</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_self-&gt;L1 = __pyx_t_3;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:         <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_int_2, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0777</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_self-&gt;L2 = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0778</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>:         <span class="c"># Copy the contents</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:         <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_array, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0781</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">N</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0782</span>:         <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = ((__pyx_v_self-&gt;L0 * __pyx_v_self-&gt;L1) * __pyx_v_self-&gt;L2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">char</span> <span class="o">*&gt;</span> <span class="n">malloc</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;VALUES = ((char *)malloc((__pyx_v_N * (sizeof(char)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0784</span>:         <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_N;
  __pyx_t_6 = __pyx_t_3;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_n = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">n</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_array, __pyx_v_n, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(__pyx_t_2); if (unlikely((__pyx_t_8 == (char)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    (__pyx_v_self-&gt;VALUES[__pyx_v_n]) = __pyx_t_8;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0786</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0787</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_2__cinit__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_2__cinit__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0788</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;VALUES = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0789</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:     <span class="k">def</span> <span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>/* Python wrapper */
static void __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_5__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_4__dealloc__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_4__dealloc__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0791</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;VALUES != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;VALUES);
</pre><pre class="cython line score-0">&#xA0;<span class="">0793</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">get1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_get1(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_self, int __pyx_v_i0) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get1", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0795</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span><span class="p">[</span><span class="n">i0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;VALUES[__pyx_v_i0]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0796</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0797</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">get2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_get2(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_self, int __pyx_v_i0, int __pyx_v_i1) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get2", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span><span class="p">[</span><span class="n">i0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L1</span> <span class="o">+</span> <span class="n">i1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;VALUES[((__pyx_v_i0 * __pyx_v_self-&gt;L1) + __pyx_v_i1)]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0799</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">get3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3Lut_get3(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *__pyx_v_self, int __pyx_v_i0, int __pyx_v_i1, int __pyx_v_i2) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get3", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALUES</span><span class="p">[</span><span class="n">i0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">+</span> <span class="n">i1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">+</span> <span class="n">i2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;VALUES[((((__pyx_v_i0 * __pyx_v_self-&gt;L1) * __pyx_v_self-&gt;L2) + (__pyx_v_i1 * __pyx_v_self-&gt;L2)) + __pyx_v_i2)]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0802</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">LutProvider</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider {
  PyObject_HEAD
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *EDGESRELX;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *EDGESRELY;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *EDGESRELZ;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *CASESCLASSIC;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *CASES;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING3_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING3_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING4_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING4_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING5;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING6_1_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING6_1_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING6_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING7_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING7_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING7_3;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING7_4_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING7_4_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING8;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING9;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING10_1_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING10_1_1_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING10_1_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING10_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING10_2_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING11;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING12_1_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING12_1_1_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING12_1_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING12_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING12_2_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_1_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_2_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_3;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_3_;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_4;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_5_1;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING13_5_2;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TILING14;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST3;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST4;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST6;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST7;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST10;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST12;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *TEST13;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *SUBCONFIG13;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0806</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; Class that provides a common interface to the many lookup tables</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>: <span class="sd">    used by the algorithm.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span class="sd">    All the lists of lut names are autogenerated to prevent human error.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">EDGESRELX</span> <span class="c"># Edges relative X</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">EDGESRELY</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">EDGESRELZ</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">CASESCLASSIC</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">CASES</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING3_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING3_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING4_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING4_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING5</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING6_1_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING6_1_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING6_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING7_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING7_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING7_3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING7_4_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING7_4_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING8</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING9</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0835</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING10_1_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0836</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING10_1_1_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING10_1_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING10_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0839</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING10_2_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0840</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING11</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0841</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING12_1_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0842</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING12_1_1_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING12_1_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING12_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING12_2_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_1_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_2_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_3_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0852</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0853</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_5_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING13_5_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TILING14</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST6</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST7</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST10</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST12</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">TEST13</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>:     <span class="k">cdef</span> <span class="kt">Lut</span> <span class="nf">SUBCONFIG13</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: </pre>
<pre class="cython line score-321" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0868</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">EDGESRELX</span><span class="p">,</span> <span class="n">EDGESRELY</span><span class="p">,</span> <span class="n">EDGESRELZ</span><span class="p">,</span> <span class="n">CASESCLASSIC</span><span class="p">,</span> <span class="n">CASES</span><span class="p">,</span></pre>
<pre class='cython code score-321 '>/* Python wrapper */
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_11LutProvider_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_11LutProvider_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_EDGESRELX = 0;
  PyObject *__pyx_v_EDGESRELY = 0;
  PyObject *__pyx_v_EDGESRELZ = 0;
  PyObject *__pyx_v_CASESCLASSIC = 0;
  PyObject *__pyx_v_CASES = 0;
  PyObject *__pyx_v_TILING1 = 0;
  PyObject *__pyx_v_TILING2 = 0;
  PyObject *__pyx_v_TILING3_1 = 0;
  PyObject *__pyx_v_TILING3_2 = 0;
  PyObject *__pyx_v_TILING4_1 = 0;
  PyObject *__pyx_v_TILING4_2 = 0;
  PyObject *__pyx_v_TILING5 = 0;
  PyObject *__pyx_v_TILING6_1_1 = 0;
  PyObject *__pyx_v_TILING6_1_2 = 0;
  PyObject *__pyx_v_TILING6_2 = 0;
  PyObject *__pyx_v_TILING7_1 = 0;
  PyObject *__pyx_v_TILING7_2 = 0;
  PyObject *__pyx_v_TILING7_3 = 0;
  PyObject *__pyx_v_TILING7_4_1 = 0;
  PyObject *__pyx_v_TILING7_4_2 = 0;
  PyObject *__pyx_v_TILING8 = 0;
  PyObject *__pyx_v_TILING9 = 0;
  PyObject *__pyx_v_TILING10_1_1 = 0;
  PyObject *__pyx_v_TILING10_1_1_ = 0;
  PyObject *__pyx_v_TILING10_1_2 = 0;
  PyObject *__pyx_v_TILING10_2 = 0;
  PyObject *__pyx_v_TILING10_2_ = 0;
  PyObject *__pyx_v_TILING11 = 0;
  PyObject *__pyx_v_TILING12_1_1 = 0;
  PyObject *__pyx_v_TILING12_1_1_ = 0;
  PyObject *__pyx_v_TILING12_1_2 = 0;
  PyObject *__pyx_v_TILING12_2 = 0;
  PyObject *__pyx_v_TILING12_2_ = 0;
  PyObject *__pyx_v_TILING13_1 = 0;
  PyObject *__pyx_v_TILING13_1_ = 0;
  PyObject *__pyx_v_TILING13_2 = 0;
  PyObject *__pyx_v_TILING13_2_ = 0;
  PyObject *__pyx_v_TILING13_3 = 0;
  PyObject *__pyx_v_TILING13_3_ = 0;
  PyObject *__pyx_v_TILING13_4 = 0;
  PyObject *__pyx_v_TILING13_5_1 = 0;
  PyObject *__pyx_v_TILING13_5_2 = 0;
  PyObject *__pyx_v_TILING14 = 0;
  PyObject *__pyx_v_TEST3 = 0;
  PyObject *__pyx_v_TEST4 = 0;
  PyObject *__pyx_v_TEST6 = 0;
  PyObject *__pyx_v_TEST7 = 0;
  PyObject *__pyx_v_TEST10 = 0;
  PyObject *__pyx_v_TEST12 = 0;
  PyObject *__pyx_v_TEST13 = 0;
  PyObject *__pyx_v_SUBCONFIG13 = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_EDGESRELX,&amp;__pyx_n_s_EDGESRELY,&amp;__pyx_n_s_EDGESRELZ,&amp;__pyx_n_s_CASESCLASSIC,&amp;__pyx_n_s_CASES,&amp;__pyx_n_s_TILING1,&amp;__pyx_n_s_TILING2,&amp;__pyx_n_s_TILING3_1,&amp;__pyx_n_s_TILING3_2,&amp;__pyx_n_s_TILING4_1,&amp;__pyx_n_s_TILING4_2,&amp;__pyx_n_s_TILING5,&amp;__pyx_n_s_TILING6_1_1,&amp;__pyx_n_s_TILING6_1_2,&amp;__pyx_n_s_TILING6_2,&amp;__pyx_n_s_TILING7_1,&amp;__pyx_n_s_TILING7_2,&amp;__pyx_n_s_TILING7_3,&amp;__pyx_n_s_TILING7_4_1,&amp;__pyx_n_s_TILING7_4_2,&amp;__pyx_n_s_TILING8,&amp;__pyx_n_s_TILING9,&amp;__pyx_n_s_TILING10_1_1,&amp;__pyx_n_s_TILING10_1_1_2,&amp;__pyx_n_s_TILING10_1_2,&amp;__pyx_n_s_TILING10_2,&amp;__pyx_n_s_TILING10_2_2,&amp;__pyx_n_s_TILING11,&amp;__pyx_n_s_TILING12_1_1,&amp;__pyx_n_s_TILING12_1_1_2,&amp;__pyx_n_s_TILING12_1_2,&amp;__pyx_n_s_TILING12_2,&amp;__pyx_n_s_TILING12_2_2,&amp;__pyx_n_s_TILING13_1,&amp;__pyx_n_s_TILING13_1_2,&amp;__pyx_n_s_TILING13_2,&amp;__pyx_n_s_TILING13_2_2,&amp;__pyx_n_s_TILING13_3,&amp;__pyx_n_s_TILING13_3_2,&amp;__pyx_n_s_TILING13_4,&amp;__pyx_n_s_TILING13_5_1,&amp;__pyx_n_s_TILING13_5_2,&amp;__pyx_n_s_TILING14,&amp;__pyx_n_s_TEST3,&amp;__pyx_n_s_TEST4,&amp;__pyx_n_s_TEST6,&amp;__pyx_n_s_TEST7,&amp;__pyx_n_s_TEST10,&amp;__pyx_n_s_TEST12,&amp;__pyx_n_s_TEST13,&amp;__pyx_n_s_SUBCONFIG13,0};
    PyObject* values[51] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 51: values[50] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 50);
        CYTHON_FALLTHROUGH;
        case 50: values[49] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 49);
        CYTHON_FALLTHROUGH;
        case 49: values[48] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 48);
        CYTHON_FALLTHROUGH;
        case 48: values[47] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 47);
        CYTHON_FALLTHROUGH;
        case 47: values[46] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 46);
        CYTHON_FALLTHROUGH;
        case 46: values[45] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 45);
        CYTHON_FALLTHROUGH;
        case 45: values[44] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 44);
        CYTHON_FALLTHROUGH;
        case 44: values[43] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 43);
        CYTHON_FALLTHROUGH;
        case 43: values[42] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 42);
        CYTHON_FALLTHROUGH;
        case 42: values[41] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 41);
        CYTHON_FALLTHROUGH;
        case 41: values[40] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 40);
        CYTHON_FALLTHROUGH;
        case 40: values[39] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 39);
        CYTHON_FALLTHROUGH;
        case 39: values[38] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 38);
        CYTHON_FALLTHROUGH;
        case 38: values[37] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 37);
        CYTHON_FALLTHROUGH;
        case 37: values[36] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 36);
        CYTHON_FALLTHROUGH;
        case 36: values[35] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 35);
        CYTHON_FALLTHROUGH;
        case 35: values[34] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 34);
        CYTHON_FALLTHROUGH;
        case 34: values[33] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 33);
        CYTHON_FALLTHROUGH;
        case 33: values[32] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 32);
        CYTHON_FALLTHROUGH;
        case 32: values[31] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 31);
        CYTHON_FALLTHROUGH;
        case 31: values[30] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 30);
        CYTHON_FALLTHROUGH;
        case 30: values[29] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 29);
        CYTHON_FALLTHROUGH;
        case 29: values[28] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 28);
        CYTHON_FALLTHROUGH;
        case 28: values[27] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 27);
        CYTHON_FALLTHROUGH;
        case 27: values[26] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 26);
        CYTHON_FALLTHROUGH;
        case 26: values[25] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 25);
        CYTHON_FALLTHROUGH;
        case 25: values[24] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 24);
        CYTHON_FALLTHROUGH;
        case 24: values[23] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 23);
        CYTHON_FALLTHROUGH;
        case 23: values[22] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_EDGESRELX)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_EDGESRELY)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 1); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_EDGESRELZ)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 2); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_CASESCLASSIC)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 3); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_CASES)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 4); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 5); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 6); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING3_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 7); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING3_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 8); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING4_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 9); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING4_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 10); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (likely((values[11] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING5)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 11); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (likely((values[12] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING6_1_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 12); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (likely((values[13] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING6_1_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 13); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (likely((values[14] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING6_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 14); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (likely((values[15] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING7_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 15); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (likely((values[16] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING7_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 16); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (likely((values[17] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING7_3)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 17); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (likely((values[18] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING7_4_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 18); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (likely((values[19] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING7_4_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 19); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (likely((values[20] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING8)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 20); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (likely((values[21] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING9)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 21); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 22:
        if (likely((values[22] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING10_1_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 22); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 23:
        if (likely((values[23] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING10_1_1_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 23); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 24:
        if (likely((values[24] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING10_1_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 24); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 25:
        if (likely((values[25] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING10_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 25); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 26:
        if (likely((values[26] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING10_2_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 26); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 27:
        if (likely((values[27] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING11)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 27); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 28:
        if (likely((values[28] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING12_1_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 28); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 29:
        if (likely((values[29] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING12_1_1_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 29); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 30:
        if (likely((values[30] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING12_1_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 30); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 31:
        if (likely((values[31] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING12_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 31); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 32:
        if (likely((values[32] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING12_2_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 32); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 33:
        if (likely((values[33] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 33); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 34:
        if (likely((values[34] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_1_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 34); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 35:
        if (likely((values[35] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 35); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 36:
        if (likely((values[36] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_2_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 36); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 37:
        if (likely((values[37] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_3)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 37); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 38:
        if (likely((values[38] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_3_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 38); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 39:
        if (likely((values[39] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_4)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 39); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 40:
        if (likely((values[40] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_5_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 40); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 41:
        if (likely((values[41] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING13_5_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 41); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 42:
        if (likely((values[42] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TILING14)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 42); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 43:
        if (likely((values[43] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST3)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 43); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 44:
        if (likely((values[44] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST4)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 44); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 45:
        if (likely((values[45] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST6)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 45); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 46:
        if (likely((values[46] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST7)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 46); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 47:
        if (likely((values[47] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST10)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 47); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 48:
        if (likely((values[48] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST12)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 48); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 49:
        if (likely((values[49] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_TEST13)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 49); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 50:
        if (likely((values[50] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_SUBCONFIG13)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, 50); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 51) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
      values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
      values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
      values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
      values[17] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 17);
      values[18] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 18);
      values[19] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 19);
      values[20] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 20);
      values[21] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 21);
      values[22] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 22);
      values[23] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 23);
      values[24] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 24);
      values[25] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 25);
      values[26] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 26);
      values[27] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 27);
      values[28] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 28);
      values[29] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 29);
      values[30] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 30);
      values[31] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 31);
      values[32] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 32);
      values[33] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 33);
      values[34] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 34);
      values[35] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 35);
      values[36] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 36);
      values[37] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 37);
      values[38] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 38);
      values[39] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 39);
      values[40] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 40);
      values[41] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 41);
      values[42] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 42);
      values[43] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 43);
      values[44] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 44);
      values[45] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 45);
      values[46] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 46);
      values[47] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 47);
      values[48] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 48);
      values[49] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 49);
      values[50] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 50);
    }
    __pyx_v_EDGESRELX = values[0];
    __pyx_v_EDGESRELY = values[1];
    __pyx_v_EDGESRELZ = values[2];
    __pyx_v_CASESCLASSIC = values[3];
    __pyx_v_CASES = values[4];
    __pyx_v_TILING1 = values[5];
    __pyx_v_TILING2 = values[6];
    __pyx_v_TILING3_1 = values[7];
    __pyx_v_TILING3_2 = values[8];
    __pyx_v_TILING4_1 = values[9];
    __pyx_v_TILING4_2 = values[10];
    __pyx_v_TILING5 = values[11];
    __pyx_v_TILING6_1_1 = values[12];
    __pyx_v_TILING6_1_2 = values[13];
    __pyx_v_TILING6_2 = values[14];
    __pyx_v_TILING7_1 = values[15];
    __pyx_v_TILING7_2 = values[16];
    __pyx_v_TILING7_3 = values[17];
    __pyx_v_TILING7_4_1 = values[18];
    __pyx_v_TILING7_4_2 = values[19];
    __pyx_v_TILING8 = values[20];
    __pyx_v_TILING9 = values[21];
    __pyx_v_TILING10_1_1 = values[22];
    __pyx_v_TILING10_1_1_ = values[23];
    __pyx_v_TILING10_1_2 = values[24];
    __pyx_v_TILING10_2 = values[25];
    __pyx_v_TILING10_2_ = values[26];
    __pyx_v_TILING11 = values[27];
    __pyx_v_TILING12_1_1 = values[28];
    __pyx_v_TILING12_1_1_ = values[29];
    __pyx_v_TILING12_1_2 = values[30];
    __pyx_v_TILING12_2 = values[31];
    __pyx_v_TILING12_2_ = values[32];
    __pyx_v_TILING13_1 = values[33];
    __pyx_v_TILING13_1_ = values[34];
    __pyx_v_TILING13_2 = values[35];
    __pyx_v_TILING13_2_ = values[36];
    __pyx_v_TILING13_3 = values[37];
    __pyx_v_TILING13_3_ = values[38];
    __pyx_v_TILING13_4 = values[39];
    __pyx_v_TILING13_5_1 = values[40];
    __pyx_v_TILING13_5_2 = values[41];
    __pyx_v_TILING14 = values[42];
    __pyx_v_TEST3 = values[43];
    __pyx_v_TEST4 = values[44];
    __pyx_v_TEST6 = values[45];
    __pyx_v_TEST7 = values[46];
    __pyx_v_TEST10 = values[47];
    __pyx_v_TEST12 = values[48];
    __pyx_v_TEST13 = values[49];
    __pyx_v_SUBCONFIG13 = values[50];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 51, 51, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.LutProvider.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_11LutProvider___init__(((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *)__pyx_v_self), __pyx_v_EDGESRELX, __pyx_v_EDGESRELY, __pyx_v_EDGESRELZ, __pyx_v_CASESCLASSIC, __pyx_v_CASES, __pyx_v_TILING1, __pyx_v_TILING2, __pyx_v_TILING3_1, __pyx_v_TILING3_2, __pyx_v_TILING4_1, __pyx_v_TILING4_2, __pyx_v_TILING5, __pyx_v_TILING6_1_1, __pyx_v_TILING6_1_2, __pyx_v_TILING6_2, __pyx_v_TILING7_1, __pyx_v_TILING7_2, __pyx_v_TILING7_3, __pyx_v_TILING7_4_1, __pyx_v_TILING7_4_2, __pyx_v_TILING8, __pyx_v_TILING9, __pyx_v_TILING10_1_1, __pyx_v_TILING10_1_1_, __pyx_v_TILING10_1_2, __pyx_v_TILING10_2, __pyx_v_TILING10_2_, __pyx_v_TILING11, __pyx_v_TILING12_1_1, __pyx_v_TILING12_1_1_, __pyx_v_TILING12_1_2, __pyx_v_TILING12_2, __pyx_v_TILING12_2_, __pyx_v_TILING13_1, __pyx_v_TILING13_1_, __pyx_v_TILING13_2, __pyx_v_TILING13_2_, __pyx_v_TILING13_3, __pyx_v_TILING13_3_, __pyx_v_TILING13_4, __pyx_v_TILING13_5_1, __pyx_v_TILING13_5_2, __pyx_v_TILING14, __pyx_v_TEST3, __pyx_v_TEST4, __pyx_v_TEST6, __pyx_v_TEST7, __pyx_v_TEST10, __pyx_v_TEST12, __pyx_v_TEST13, __pyx_v_SUBCONFIG13);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_11LutProvider___init__(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_self, PyObject *__pyx_v_EDGESRELX, PyObject *__pyx_v_EDGESRELY, PyObject *__pyx_v_EDGESRELZ, PyObject *__pyx_v_CASESCLASSIC, PyObject *__pyx_v_CASES, PyObject *__pyx_v_TILING1, PyObject *__pyx_v_TILING2, PyObject *__pyx_v_TILING3_1, PyObject *__pyx_v_TILING3_2, PyObject *__pyx_v_TILING4_1, PyObject *__pyx_v_TILING4_2, PyObject *__pyx_v_TILING5, PyObject *__pyx_v_TILING6_1_1, PyObject *__pyx_v_TILING6_1_2, PyObject *__pyx_v_TILING6_2, PyObject *__pyx_v_TILING7_1, PyObject *__pyx_v_TILING7_2, PyObject *__pyx_v_TILING7_3, PyObject *__pyx_v_TILING7_4_1, PyObject *__pyx_v_TILING7_4_2, PyObject *__pyx_v_TILING8, PyObject *__pyx_v_TILING9, PyObject *__pyx_v_TILING10_1_1, PyObject *__pyx_v_TILING10_1_1_, PyObject *__pyx_v_TILING10_1_2, PyObject *__pyx_v_TILING10_2, PyObject *__pyx_v_TILING10_2_, PyObject *__pyx_v_TILING11, PyObject *__pyx_v_TILING12_1_1, PyObject *__pyx_v_TILING12_1_1_, PyObject *__pyx_v_TILING12_1_2, PyObject *__pyx_v_TILING12_2, PyObject *__pyx_v_TILING12_2_, PyObject *__pyx_v_TILING13_1, PyObject *__pyx_v_TILING13_1_, PyObject *__pyx_v_TILING13_2, PyObject *__pyx_v_TILING13_2_, PyObject *__pyx_v_TILING13_3, PyObject *__pyx_v_TILING13_3_, PyObject *__pyx_v_TILING13_4, PyObject *__pyx_v_TILING13_5_1, PyObject *__pyx_v_TILING13_5_2, PyObject *__pyx_v_TILING14, PyObject *__pyx_v_TEST3, PyObject *__pyx_v_TEST4, PyObject *__pyx_v_TEST6, PyObject *__pyx_v_TEST7, PyObject *__pyx_v_TEST10, PyObject *__pyx_v_TEST12, PyObject *__pyx_v_TEST13, PyObject *__pyx_v_SUBCONFIG13) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.LutProvider.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0869</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>:             <span class="n">TILING1</span><span class="p">,</span> <span class="n">TILING2</span><span class="p">,</span> <span class="n">TILING3_1</span><span class="p">,</span> <span class="n">TILING3_2</span><span class="p">,</span> <span class="n">TILING4_1</span><span class="p">,</span> <span class="n">TILING4_2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>:             <span class="n">TILING5</span><span class="p">,</span> <span class="n">TILING6_1_1</span><span class="p">,</span> <span class="n">TILING6_1_2</span><span class="p">,</span> <span class="n">TILING6_2</span><span class="p">,</span> <span class="n">TILING7_1</span><span class="p">,</span> <span class="n">TILING7_2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>:             <span class="n">TILING7_3</span><span class="p">,</span> <span class="n">TILING7_4_1</span><span class="p">,</span> <span class="n">TILING7_4_2</span><span class="p">,</span> <span class="n">TILING8</span><span class="p">,</span> <span class="n">TILING9</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>:             <span class="n">TILING10_1_1</span><span class="p">,</span> <span class="n">TILING10_1_1_</span><span class="p">,</span> <span class="n">TILING10_1_2</span><span class="p">,</span> <span class="n">TILING10_2</span><span class="p">,</span> <span class="n">TILING10_2_</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>:             <span class="n">TILING11</span><span class="p">,</span> <span class="n">TILING12_1_1</span><span class="p">,</span> <span class="n">TILING12_1_1_</span><span class="p">,</span> <span class="n">TILING12_1_2</span><span class="p">,</span> <span class="n">TILING12_2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>:             <span class="n">TILING12_2_</span><span class="p">,</span> <span class="n">TILING13_1</span><span class="p">,</span> <span class="n">TILING13_1_</span><span class="p">,</span> <span class="n">TILING13_2</span><span class="p">,</span> <span class="n">TILING13_2_</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>:             <span class="n">TILING13_3</span><span class="p">,</span> <span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">TILING13_4</span><span class="p">,</span> <span class="n">TILING13_5_1</span><span class="p">,</span> <span class="n">TILING13_5_2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>:             <span class="n">TILING14</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>:             <span class="n">TEST3</span><span class="p">,</span> <span class="n">TEST4</span><span class="p">,</span> <span class="n">TEST6</span><span class="p">,</span> <span class="n">TEST7</span><span class="p">,</span> <span class="n">TEST10</span><span class="p">,</span> <span class="n">TEST12</span><span class="p">,</span> <span class="n">TEST13</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>:             <span class="n">SUBCONFIG13</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>:             <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0883</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">EDGESRELX</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">EDGESRELX</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_EDGESRELX);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;EDGESRELX);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;EDGESRELX));
  __pyx_v_self-&gt;EDGESRELX = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0884</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">EDGESRELY</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">EDGESRELY</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_EDGESRELY);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;EDGESRELY);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;EDGESRELY));
  __pyx_v_self-&gt;EDGESRELY = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0885</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">EDGESRELZ</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">EDGESRELZ</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_EDGESRELZ);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;EDGESRELZ);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;EDGESRELZ));
  __pyx_v_self-&gt;EDGESRELZ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0886</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0887</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">CASESCLASSIC</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">CASESCLASSIC</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_CASESCLASSIC);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;CASESCLASSIC);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;CASESCLASSIC));
  __pyx_v_self-&gt;CASESCLASSIC = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0888</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">CASES</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">CASES</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_CASES);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;CASES);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;CASES));
  __pyx_v_self-&gt;CASES = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0889</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING1));
  __pyx_v_self-&gt;TILING1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING2));
  __pyx_v_self-&gt;TILING2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0892</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING3_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING3_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING3_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING3_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING3_1));
  __pyx_v_self-&gt;TILING3_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0893</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING3_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING3_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING3_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING3_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING3_2));
  __pyx_v_self-&gt;TILING3_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0894</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING4_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING4_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING4_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING4_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING4_1));
  __pyx_v_self-&gt;TILING4_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0895</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING4_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING4_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING4_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING4_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING4_2));
  __pyx_v_self-&gt;TILING4_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0896</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING5</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING5</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING5));
  __pyx_v_self-&gt;TILING5 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0897</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING6_1_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING6_1_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING6_1_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING6_1_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING6_1_1));
  __pyx_v_self-&gt;TILING6_1_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0898</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING6_1_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING6_1_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING6_1_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING6_1_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING6_1_2));
  __pyx_v_self-&gt;TILING6_1_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0899</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING6_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING6_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING6_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING6_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING6_2));
  __pyx_v_self-&gt;TILING6_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0900</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING7_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING7_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING7_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING7_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING7_1));
  __pyx_v_self-&gt;TILING7_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0901</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING7_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING7_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING7_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING7_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING7_2));
  __pyx_v_self-&gt;TILING7_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0902</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING7_3</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING7_3</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING7_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 902, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING7_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING7_3));
  __pyx_v_self-&gt;TILING7_3 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING7_4_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING7_4_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING7_4_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING7_4_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING7_4_1));
  __pyx_v_self-&gt;TILING7_4_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING7_4_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING7_4_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING7_4_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING7_4_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING7_4_2));
  __pyx_v_self-&gt;TILING7_4_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING8</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING8</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING8));
  __pyx_v_self-&gt;TILING8 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0906</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING9</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING9</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 906, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING9));
  __pyx_v_self-&gt;TILING9 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0907</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING10_1_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING10_1_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING10_1_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING10_1_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING10_1_1));
  __pyx_v_self-&gt;TILING10_1_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING10_1_1_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING10_1_1_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING10_1_1_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING10_1_1_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING10_1_1_));
  __pyx_v_self-&gt;TILING10_1_1_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING10_1_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING10_1_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING10_1_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING10_1_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING10_1_2));
  __pyx_v_self-&gt;TILING10_1_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0910</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING10_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING10_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING10_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING10_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING10_2));
  __pyx_v_self-&gt;TILING10_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING10_2_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING10_2_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING10_2_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING10_2_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING10_2_));
  __pyx_v_self-&gt;TILING10_2_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0912</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING11</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING11</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING11));
  __pyx_v_self-&gt;TILING11 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING12_1_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING12_1_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING12_1_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 913, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING12_1_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING12_1_1));
  __pyx_v_self-&gt;TILING12_1_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0914</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING12_1_1_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING12_1_1_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING12_1_1_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 914, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING12_1_1_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING12_1_1_));
  __pyx_v_self-&gt;TILING12_1_1_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0915</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING12_1_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING12_1_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING12_1_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING12_1_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING12_1_2));
  __pyx_v_self-&gt;TILING12_1_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0916</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING12_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING12_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING12_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING12_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING12_2));
  __pyx_v_self-&gt;TILING12_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0917</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING12_2_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING12_2_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING12_2_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 917, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING12_2_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING12_2_));
  __pyx_v_self-&gt;TILING12_2_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_1));
  __pyx_v_self-&gt;TILING13_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_1_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_1_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_1_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_1_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_1_));
  __pyx_v_self-&gt;TILING13_1_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_2));
  __pyx_v_self-&gt;TILING13_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_2_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_2_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_2_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_2_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_2_));
  __pyx_v_self-&gt;TILING13_2_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0922</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_3</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_3</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 922, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_3));
  __pyx_v_self-&gt;TILING13_3 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0923</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_3_</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_3_</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_3_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_3_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_3_));
  __pyx_v_self-&gt;TILING13_3_ = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0924</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_4</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_4</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_4));
  __pyx_v_self-&gt;TILING13_4 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0925</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_5_1</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_5_1</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_5_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_5_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_5_1));
  __pyx_v_self-&gt;TILING13_5_1 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0926</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING13_5_2</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING13_5_2</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING13_5_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING13_5_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING13_5_2));
  __pyx_v_self-&gt;TILING13_5_2 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TILING14</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TILING14</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TILING14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TILING14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TILING14));
  __pyx_v_self-&gt;TILING14 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0928</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0929</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST3</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST3</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST3));
  __pyx_v_self-&gt;TEST3 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0930</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST4</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST4</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST4));
  __pyx_v_self-&gt;TEST4 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0931</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST6</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST6</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST6));
  __pyx_v_self-&gt;TEST6 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0932</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST7</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST7</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST7));
  __pyx_v_self-&gt;TEST7 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0933</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST10</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST10</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 933, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST10));
  __pyx_v_self-&gt;TEST10 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0934</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST12</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST12</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 934, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST12));
  __pyx_v_self-&gt;TEST12 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0935</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">TEST13</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">TEST13</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_TEST13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;TEST13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;TEST13));
  __pyx_v_self-&gt;TEST13 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0936</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0937</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">SUBCONFIG13</span> <span class="o">=</span> <span class="n">Lut</span><span class="p">(</span><span class="n">SUBCONFIG13</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut), __pyx_v_SUBCONFIG13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;SUBCONFIG13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;SUBCONFIG13));
  __pyx_v_self-&gt;SUBCONFIG13 = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-93" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0940</span>: <span class="k">def</span> <span class="nf">marching_cubes</span><span class="p">(</span><span class="nb">float</span> <span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">im</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span> <span class="n">isovalue</span><span class="p">,</span> <span class="n">LutProvider</span> <span class="n">luts</span><span class="p">,</span> <span class="nb">int</span> <span class="n">st</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">classic</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-93 '>/* Python wrapper */
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3marching_cubes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_2marching_cubes[] = " marching_cubes(im, double isovalue, LutProvider luts, int st=1, int classic=0)\n    This is the main entry to apply marching cubes.\n    Returns (vertices, faces, normals, values)\n    ";
static PyMethodDef __pyx_mdef_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3marching_cubes = {"marching_cubes", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3marching_cubes, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_2marching_cubes};
static PyObject *__pyx_pw_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3marching_cubes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_im = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_isovalue;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_luts = 0;
  int __pyx_v_st;
  int __pyx_v_classic;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("marching_cubes (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_im,&amp;__pyx_n_s_isovalue,&amp;__pyx_n_s_luts,&amp;__pyx_n_s_st,&amp;__pyx_n_s_classic,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_im)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_isovalue)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("marching_cubes", 0, 3, 5, 1); <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_luts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("marching_cubes", 0, 3, 5, 2); <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_st);
          if (value) { values[3] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_classic);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "marching_cubes") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_im = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_im.memview)) __PYX_ERR(0, 940, __pyx_L3_error)</span>
    __pyx_v_isovalue = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_isovalue == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
    __pyx_v_luts = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *)values[2]);
    if (values[3]) {
      __pyx_v_st = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_st == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
    } else {
      __pyx_v_st = ((int)1);
    }
    if (values[4]) {
      __pyx_v_classic = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_classic == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
    } else {
      __pyx_v_classic = ((int)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("marching_cubes", 0, 3, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.marching_cubes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_im.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "im"); <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L1_error)</span>
  }
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_luts), __pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider, 1, "luts", 0))) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_2marching_cubes(__pyx_self, __pyx_v_im, __pyx_v_isovalue, __pyx_v_luts, __pyx_v_st, __pyx_v_classic);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_2marching_cubes(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_im, double __pyx_v_isovalue, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_luts, int __pyx_v_st, int __pyx_v_classic) {
  int __pyx_v_Nx;
  int __pyx_v_Ny;
  int __pyx_v_Nz;
  struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_cell = 0;
  int __pyx_v_x;
  int __pyx_v_y;
  int __pyx_v_z;
  int __pyx_v_x_st;
  int __pyx_v_y_st;
  int __pyx_v_z_st;
  int __pyx_v_nt;
  int __pyx_v_case;
  int __pyx_v_config;
  int __pyx_v_Nx_bound;
  int __pyx_v_Ny_bound;
  int __pyx_v_Nz_bound;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("marching_cubes", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_36);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_37);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("simnibs.segmentation._marching_cubes_lewiner_cy.marching_cubes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cell);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_im, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(22, __pyx_n_s_im, __pyx_n_s_isovalue, __pyx_n_s_luts, __pyx_n_s_st, __pyx_n_s_classic, __pyx_n_s_Nx, __pyx_n_s_Ny, __pyx_n_s_Nz, __pyx_n_s_cell, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_z, __pyx_n_s_x_st, __pyx_n_s_y_st, __pyx_n_s_z_st, __pyx_n_s_nt, __pyx_n_s_case, __pyx_n_s_config, __pyx_n_s_subconfig, __pyx_n_s_Nx_bound, __pyx_n_s_Ny_bound, __pyx_n_s_Nz_bound);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_3marching_cubes, NULL, __pyx_n_s_simnibs_segmentation__marching_c_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_marching_cubes, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 22, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_simnibs_segmentation__marching_c, __pyx_n_s_marching_cubes, 940, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0941</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; marching_cubes(im, double isovalue, LutProvider luts, int st=1, int classic=0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>: <span class="sd">    This is the main entry to apply marching cubes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>: <span class="sd">    Returns (vertices, faces, normals, values)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>:     <span class="c"># Get dimemsnions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">Nx</span><span class="p">,</span> <span class="nf">Ny</span><span class="p">,</span> <span class="nf">Nz</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0948</span>:     <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_im.shape[2]);
  __pyx_t_2 = (__pyx_v_im.shape[1]);
  __pyx_t_3 = (__pyx_v_im.shape[0]);
  __pyx_v_Nx = __pyx_t_1;
  __pyx_v_Ny = __pyx_t_2;
  __pyx_v_Nz = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0949</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>:     <span class="c"># Create cell to use throughout</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0951</span>:     <span class="k">cdef</span> <span class="kt">Cell</span> <span class="nf">cell</span> <span class="o">=</span> <span class="n">Cell</span><span class="p">(</span><span class="n">luts</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Nx);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 951, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Ny);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 951, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_Nz);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 951, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 951, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_luts));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_luts));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, ((PyObject *)__pyx_v_luts));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_t_6);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell), __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 951, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_cell = ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0952</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>:     <span class="c"># Typedef variables</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">x</span><span class="p">,</span> <span class="nf">y</span><span class="p">,</span> <span class="nf">z</span><span class="p">,</span> <span class="nf">x_st</span><span class="p">,</span> <span class="nf">y_st</span><span class="p">,</span> <span class="nf">z_st</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">case</span><span class="p">,</span> <span class="nf">config</span><span class="p">,</span> <span class="nf">subconfig</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>:     <span class="c"># Unfortunately specifying a step in range() siginificantly degrades</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>:     <span class="c"># performance. Therefore we use a while loop.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>:     <span class="c"># we have:  max_x = Nx_bound + st + st - 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>:     <span class="c">#       -&gt;  Nx_bound = max_allowable_x + 1 - 2 * st</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>:     <span class="c">#       -&gt;  Nx_bound = Nx - 2 * st</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0963</span>:     <span class="k">assert</span> <span class="n">st</span> <span class="o">&gt;</span> <span class="mf">0</span></pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!((__pyx_v_st &gt; 0) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">0964</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">Nx_bound</span><span class="p">,</span> <span class="nf">Ny_bound</span><span class="p">,</span> <span class="nf">Nz_bound</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0965</span>:     <span class="n">Nx_bound</span><span class="p">,</span> <span class="n">Ny_bound</span><span class="p">,</span> <span class="n">Nz_bound</span> <span class="o">=</span> <span class="n">Nx</span> <span class="o">-</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span> <span class="n">Ny</span> <span class="o">-</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span> <span class="n">Nz</span> <span class="o">-</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">st</span>  <span class="c"># precalculated index range</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_Nx - (2 * __pyx_v_st));
  __pyx_t_9 = (__pyx_v_Ny - (2 * __pyx_v_st));
  __pyx_t_10 = (__pyx_v_Nz - (2 * __pyx_v_st));
  __pyx_v_Nx_bound = __pyx_t_8;
  __pyx_v_Ny_bound = __pyx_t_9;
  __pyx_v_Nz_bound = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0966</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>:     <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="n">st</span></pre>
<pre class='cython code score-0 '>  __pyx_v_z = (-__pyx_v_st);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0968</span>:     <span class="k">while</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="n">Nz_bound</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_11 = ((__pyx_v_z &lt; __pyx_v_Nz_bound) != 0);
    if (!__pyx_t_11) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0969</span>:         <span class="n">z</span> <span class="o">+=</span> <span class="n">st</span></pre>
<pre class='cython code score-0 '>    __pyx_v_z = (__pyx_v_z + __pyx_v_st);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0970</span>:         <span class="n">z_st</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">st</span></pre>
<pre class='cython code score-0 '>    __pyx_v_z_st = (__pyx_v_z + __pyx_v_st);
</pre><pre class="cython line score-0">&#xA0;<span class="">0971</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0972</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">new_z_value</span><span class="p">()</span>  <span class="c"># Indicate that we enter a new layer</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;new_z_value(__pyx_v_cell);
</pre><pre class="cython line score-0">&#xA0;<span class="">0973</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0974</span>:         <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">st</span></pre>
<pre class='cython code score-0 '>    __pyx_v_y = (-__pyx_v_st);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0975</span>:         <span class="k">while</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">Ny_bound</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_11 = ((__pyx_v_y &lt; __pyx_v_Ny_bound) != 0);
      if (!__pyx_t_11) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0976</span>:             <span class="n">y</span> <span class="o">+=</span> <span class="n">st</span></pre>
<pre class='cython code score-0 '>      __pyx_v_y = (__pyx_v_y + __pyx_v_st);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0977</span>:             <span class="n">y_st</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">st</span></pre>
<pre class='cython code score-0 '>      __pyx_v_y_st = (__pyx_v_y + __pyx_v_st);
</pre><pre class="cython line score-0">&#xA0;<span class="">0978</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0979</span>:             <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">st</span></pre>
<pre class='cython code score-0 '>      __pyx_v_x = (-__pyx_v_st);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0980</span>:             <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">Nx_bound</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_11 = ((__pyx_v_x &lt; __pyx_v_Nx_bound) != 0);
        if (!__pyx_t_11) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0981</span>:                 <span class="n">x</span> <span class="o">+=</span> <span class="n">st</span></pre>
<pre class='cython code score-0 '>        __pyx_v_x = (__pyx_v_x + __pyx_v_st);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0982</span>:                 <span class="n">x_st</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">st</span></pre>
<pre class='cython code score-0 '>        __pyx_v_x_st = (__pyx_v_x + __pyx_v_st);
</pre><pre class="cython line score-0">&#xA0;<span class="">0983</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>:                 <span class="c"># Initialize cell</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0985</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">set_cube</span><span class="p">(</span><span class="n">isovalue</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;set_cube(__pyx_v_cell, __pyx_v_isovalue, __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_st, (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_12 * __pyx_v_im.strides[0]) ) + __pyx_t_13 * __pyx_v_im.strides[1]) ) + __pyx_t_14 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_15 * __pyx_v_im.strides[0]) ) + __pyx_t_16 * __pyx_v_im.strides[1]) ) + __pyx_t_17 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_18 * __pyx_v_im.strides[0]) ) + __pyx_t_19 * __pyx_v_im.strides[1]) ) + __pyx_t_20 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_21 * __pyx_v_im.strides[0]) ) + __pyx_t_22 * __pyx_v_im.strides[1]) ) + __pyx_t_23 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_24 * __pyx_v_im.strides[0]) ) + __pyx_t_25 * __pyx_v_im.strides[1]) ) + __pyx_t_26 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_27 * __pyx_v_im.strides[0]) ) + __pyx_t_28 * __pyx_v_im.strides[1]) ) + __pyx_t_29 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_30 * __pyx_v_im.strides[0]) ) + __pyx_t_31 * __pyx_v_im.strides[1]) ) + __pyx_t_32 * __pyx_v_im.strides[2]) ))), (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_im.data + __pyx_t_33 * __pyx_v_im.strides[0]) ) + __pyx_t_34 * __pyx_v_im.strides[1]) ) + __pyx_t_35 * __pyx_v_im.strides[2]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0986</span>:                     <span class="n">im</span><span class="p">[</span><span class="n">z</span>   <span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">im</span><span class="p">[</span><span class="n">z</span>   <span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">x_st</span><span class="p">],</span> <span class="n">im</span><span class="p">[</span><span class="n">z</span>   <span class="p">,</span><span class="n">y_st</span><span class="p">,</span> <span class="n">x_st</span><span class="p">],</span> <span class="n">im</span><span class="p">[</span><span class="n">z</span>   <span class="p">,</span><span class="n">y_st</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_z;
        __pyx_t_13 = __pyx_v_y;
        __pyx_t_14 = __pyx_v_x;
        __pyx_t_15 = __pyx_v_z;
        __pyx_t_16 = __pyx_v_y;
        __pyx_t_17 = __pyx_v_x_st;
        __pyx_t_18 = __pyx_v_z;
        __pyx_t_19 = __pyx_v_y_st;
        __pyx_t_20 = __pyx_v_x_st;
        __pyx_t_21 = __pyx_v_z;
        __pyx_t_22 = __pyx_v_y_st;
        __pyx_t_23 = __pyx_v_x;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0987</span>:                     <span class="n">im</span><span class="p">[</span><span class="n">z_st</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">im</span><span class="p">[</span><span class="n">z_st</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">x_st</span><span class="p">],</span> <span class="n">im</span><span class="p">[</span><span class="n">z_st</span><span class="p">,</span><span class="n">y_st</span><span class="p">,</span> <span class="n">x_st</span><span class="p">],</span> <span class="n">im</span><span class="p">[</span><span class="n">z_st</span><span class="p">,</span><span class="n">y_st</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_z_st;
        __pyx_t_25 = __pyx_v_y;
        __pyx_t_26 = __pyx_v_x;
        __pyx_t_27 = __pyx_v_z_st;
        __pyx_t_28 = __pyx_v_y;
        __pyx_t_29 = __pyx_v_x_st;
        __pyx_t_30 = __pyx_v_z_st;
        __pyx_t_31 = __pyx_v_y_st;
        __pyx_t_32 = __pyx_v_x_st;
        __pyx_t_33 = __pyx_v_z_st;
        __pyx_t_34 = __pyx_v_y_st;
        __pyx_t_35 = __pyx_v_x;
</pre><pre class="cython line score-0">&#xA0;<span class="">0988</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>:                 <span class="c"># Do classic!</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0990</span>:                 <span class="k">if</span> <span class="n">classic</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_classic != 0);
        if (__pyx_t_11) {
/* … */
          goto __pyx_L9;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0991</span>:                     <span class="c"># Determine number of vertices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>:                     <span class="n">nt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_nt = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>:                     <span class="k">while</span> <span class="n">luts</span><span class="o">.</span><span class="n">CASESCLASSIC</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mf">3</span><span class="o">*</span><span class="n">nt</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_11 = ((((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;CASESCLASSIC-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;CASESCLASSIC, __pyx_v_cell-&gt;index, (3 * __pyx_v_nt)) != -1L) != 0);
            if (!__pyx_t_11) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0994</span>:                         <span class="n">nt</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_v_nt = (__pyx_v_nt + 1);
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0995</span>:                     <span class="c"># Add triangles</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0996</span>:                     <span class="k">if</span> <span class="n">nt</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_11 = ((__pyx_v_nt &gt; 0) != 0);
          if (__pyx_t_11) {
/* … */
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0997</span>:                         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">CASESCLASSIC</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">nt</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>            __pyx_t_6 = ((PyObject *)__pyx_v_luts-&gt;CASESCLASSIC);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_6), __pyx_v_cell-&gt;index, __pyx_v_nt);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0998</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>:                     <span class="c"># Get case, if non-nul, enter the big switch</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1000</span>:                     <span class="n">case</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">CASES</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_case = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;CASES-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;CASES, __pyx_v_cell-&gt;index, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1001</span>:                     <span class="k">if</span> <span class="n">case</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_11 = ((__pyx_v_case &gt; 0) != 0);
          if (__pyx_t_11) {
/* … */
          }
        }
        __pyx_L9:;
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>:                         <span class="n">config</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">CASES</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_v_config = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;CASES-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;CASES, __pyx_v_cell-&gt;index, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1003</span>:                         <span class="n">the_big_switch</span><span class="p">(</span><span class="n">luts</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_the_big_switch(__pyx_v_luts, __pyx_v_cell, __pyx_v_case, __pyx_v_config);
</pre><pre class="cython line score-0">&#xA0;<span class="">1004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>:     <span class="c"># Done</span></pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1006</span>:     <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">(),</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_faces</span><span class="p">(),</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_normals</span><span class="p">(),</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span></pre>
<pre class='cython code score-82 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_cell), __pyx_n_s_get_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_6 = (__pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_cell), __pyx_n_s_get_faces);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_7 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_cell), __pyx_n_s_get_normals);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_36 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_36 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_36)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_36);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_5 = (__pyx_t_36) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_36) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_36); __pyx_t_36 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_36 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_cell), __pyx_n_s_get_values);<span class='error_goto'> if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_36);
  __pyx_t_37 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_36))) {
    __pyx_t_37 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_36);
    if (likely(__pyx_t_37)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_36);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_37);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_36, function);
    }
  }
  __pyx_t_4 = (__pyx_t_37) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_36, __pyx_t_37) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_36);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_37); __pyx_t_37 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_36); __pyx_t_36 = 0;
  __pyx_t_36 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 1, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 3, __pyx_t_4);
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_r = __pyx_t_36;
  __pyx_t_36 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1010</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">the_big_switch</span><span class="p">(</span><span class="n">LutProvider</span> <span class="n">luts</span><span class="p">,</span> <span class="n">Cell</span> <span class="n">cell</span><span class="p">,</span> <span class="nb">int</span> <span class="n">case</span><span class="p">,</span> <span class="nb">int</span> <span class="n">config</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_the_big_switch(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_luts, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_cell, int __pyx_v_case, int __pyx_v_config) {
  int __pyx_v_subconfig;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("the_big_switch", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("simnibs.segmentation._marching_cubes_lewiner_cy.the_big_switch", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1011</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; The big switch (i.e. if-statement) that I meticulously ported from</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>: <span class="sd">    the source code provided by Lewiner et. al.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>: <span class="sd">    Together with all the look-up tables, this is where the magic is ...</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">subconfig</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_subconfig = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>:     <span class="c"># Sinatures for tests</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>:     <span class="c">#test_face(cell, luts.TESTX.get1(config)):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>:     <span class="c">#test_internal(cell, luts, case, config, subconfig, luts.TESTX.get1(config)):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>:     <span class="c">#cell.add_triangles(luts.TILINGX, config, N)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1023</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1024</span>:     <span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_case) {
    case 1:
/* … */
    break;
    case 2:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1026</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1027</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 3:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1028</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1029</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 4:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1031</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST3</span><span class="o">.</span><span class="n">get1</span><span class="p">(</span><span class="n">config</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST3-&gt;__pyx_vtab)-&gt;get1(__pyx_v_luts-&gt;TEST3, __pyx_v_config)) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L3;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1032</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING3_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING3_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1033</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1034</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING3_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    /*else*/ {
      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING3_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1035</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1036</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">4</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 5:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1037</span>:         <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST4</span><span class="o">.</span><span class="n">get1</span><span class="p">(</span><span class="n">config</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST4-&gt;__pyx_vtab)-&gt;get1(__pyx_v_luts-&gt;TEST4, __pyx_v_config)) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING4_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING4_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1039</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1040</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING4_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    /*else*/ {
      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING4_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1041</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1042</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">5</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 6:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1043</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING5</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1044</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1045</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">6</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 7:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1046</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST6</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">0</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST6-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST6, __pyx_v_config, 0)) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING6_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING6_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1048</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1049</span>:             <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST6</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST6-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST6, __pyx_v_config, 1)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L6;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1050</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING6_1_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING6_1_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1051</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>:                 <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1053</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING6_1_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">9</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING6_1_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L6:;
    }
    __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1054</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1055</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">7</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 8:
</pre><pre class="cython line score-0">&#xA0;<span class="">1056</span>:         <span class="c"># Get subconfig</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1057</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST7</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">0</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST7-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST7, __pyx_v_config, 0)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 1);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1058</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST7</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST7-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST7, __pyx_v_config, 1)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 2);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1059</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST7</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">2</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST7-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST7, __pyx_v_config, 2)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 4);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1060</span>:         <span class="c"># Behavior depends on subconfig</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1061</span>:         <span class="k">if</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span> <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    switch (__pyx_v_subconfig) {
      case 0:
      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 1:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1062</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span> <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 2:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1063</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span> <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 3:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 4:
</pre><pre class="cython line score-0">&#xA0;<span class="">1065</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">9</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1067</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">4</span><span class="p">:</span> <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 5:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1068</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 6:
</pre><pre class="cython line score-0">&#xA0;<span class="">1069</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1070</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">9</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">6</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 7:
</pre><pre class="cython line score-0">&#xA0;<span class="">1072</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">9</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1074</span>:         <span class="k">elif</span> <span class="n">subconfig</span> <span class="o">==</span> <span class="mf">7</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      default: break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>:             <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST7</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">3</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST7-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST7, __pyx_v_config, 3)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L10;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1076</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_4_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">9</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_4_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1077</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1078</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING7_4_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING7_4_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L10:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1079</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">8</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 9:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING8</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1082</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1083</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">9</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 10:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING9</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1085</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1086</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">10</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 11:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST10</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">0</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST10-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST10, __pyx_v_config, 0)) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:             <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST10</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST10-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST10, __pyx_v_config, 1)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L12;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1089</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING10_1_1_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING10_1_1_);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1090</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1091</span>:                 <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING10_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING10_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L12:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1093</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>:             <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST10</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST10-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST10, __pyx_v_config, 1)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1095</span>:                 <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1096</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING10_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING10_2_);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1097</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1098</span>:                 <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST10</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">2</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST10-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST10, __pyx_v_config, 2)) != 0);
        if (__pyx_t_2) {
/* … */
          goto __pyx_L14;
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1099</span>:                     <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING10_1_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>          __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING10_1_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1100</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1101</span>:                     <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING10_1_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        /*else*/ {
          __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING10_1_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        __pyx_L14:;
      }
      __pyx_L13:;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1102</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">11</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 12:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING11</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1105</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">12</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 13:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST12</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">0</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST12-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST12, __pyx_v_config, 0)) != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L15;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:             <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST12</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST12-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST12, __pyx_v_config, 1)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L16;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING12_1_1_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING12_1_1_);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1110</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1111</span>:                 <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING12_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING12_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L16:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1113</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1114</span>:             <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST12</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST12-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST12, __pyx_v_config, 1)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L17;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1115</span>:                 <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING12_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING12_2_);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1117</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1118</span>:                 <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST12</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">2</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST12-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST12, __pyx_v_config, 2)) != 0);
        if (__pyx_t_2) {
/* … */
          goto __pyx_L18;
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:                     <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING12_1_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>          __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING12_1_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1120</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1121</span>:                     <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING12_1_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        /*else*/ {
          __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING12_1_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        __pyx_L18:;
      }
      __pyx_L17:;
    }
    __pyx_L15:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1122</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1123</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">13</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 14:
</pre><pre class="cython line score-0">&#xA0;<span class="">1124</span>:         <span class="c"># Calculate subconfig</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">0</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 0)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 1);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">1</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 1)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 2);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1127</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">2</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 2)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 4);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1128</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">3</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">8</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 3)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 8);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">4</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">16</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 4)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 16);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:         <span class="k">if</span> <span class="n">test_face</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">5</span><span class="p">)):</span> <span class="n">subconfig</span> <span class="o">+=</span> <span class="mf">32</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(__pyx_v_cell, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 5)) != 0);
    if (__pyx_t_2) {
      __pyx_v_subconfig = (__pyx_v_subconfig + 32);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1132</span>:         <span class="c"># Map via LUT</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1133</span>:         <span class="n">subconfig</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">SUBCONFIG13</span><span class="o">.</span><span class="n">get1</span><span class="p">(</span><span class="n">subconfig</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_subconfig = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;SUBCONFIG13-&gt;__pyx_vtab)-&gt;get1(__pyx_v_luts-&gt;SUBCONFIG13, __pyx_v_subconfig);
</pre><pre class="cython line score-0">&#xA0;<span class="">1134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1135</span>:         <span class="c"># Behavior depends on subconfig</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:         <span class="k">if</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span>    <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    switch (__pyx_v_subconfig) {
      case 0:
      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 1:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">1</span><span class="p">:</span>  <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 2:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">2</span><span class="p">:</span>  <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 3:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1139</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">3</span><span class="p">:</span>  <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 4:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">4</span><span class="p">:</span>  <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 5:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">5</span><span class="p">:</span>  <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 6:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">6</span><span class="p">:</span>  <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 5, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      break;
      case 7:
</pre><pre class="cython line score-0">&#xA0;<span class="">1143</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">7</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 8:
</pre><pre class="cython line score-0">&#xA0;<span class="">1145</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1146</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1147</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">8</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 9:
</pre><pre class="cython line score-0">&#xA0;<span class="">1148</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1149</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1150</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">9</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 10:
</pre><pre class="cython line score-0">&#xA0;<span class="">1151</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1152</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1153</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">10</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 11:
</pre><pre class="cython line score-0">&#xA0;<span class="">1154</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1155</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1156</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">11</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 12:
</pre><pre class="cython line score-0">&#xA0;<span class="">1157</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1158</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1159</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">12</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 13:
</pre><pre class="cython line score-0">&#xA0;<span class="">1160</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 5, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1162</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">13</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 14:
</pre><pre class="cython line score-0">&#xA0;<span class="">1163</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1164</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 6, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1165</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">14</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 15:
</pre><pre class="cython line score-0">&#xA0;<span class="">1166</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1167</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">7</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 7, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1168</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">15</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 16:
</pre><pre class="cython line score-0">&#xA0;<span class="">1169</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">16</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 17:
</pre><pre class="cython line score-0">&#xA0;<span class="">1172</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">9</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 9, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">17</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 18:
</pre><pre class="cython line score-0">&#xA0;<span class="">1175</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">10</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 10, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">18</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 19:
</pre><pre class="cython line score-0">&#xA0;<span class="">1178</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1179</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">11</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 11, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1180</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">19</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 20:
</pre><pre class="cython line score-0">&#xA0;<span class="">1182</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_4</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">12</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1184</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">20</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 21:
</pre><pre class="cython line score-0">&#xA0;<span class="">1185</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1186</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_4</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1187</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">21</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 22:
</pre><pre class="cython line score-0">&#xA0;<span class="">1188</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1189</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_4</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">12</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1190</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">22</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 23:
</pre><pre class="cython line score-0">&#xA0;<span class="">1191</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1192</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_4</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">12</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1193</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1194</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">23</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 24:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1195</span>:             <span class="n">subconfig</span> <span class="o">=</span> <span class="mf">0</span> <span class="c"># Note: the original source code sets the subconfig, without apparent reason</span></pre>
<pre class='cython code score-0 '>      __pyx_v_subconfig = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1196</span>:             <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">6</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 6)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L25;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1197</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1198</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1199</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L25:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1200</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">24</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 25:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1201</span>:             <span class="n">subconfig</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_subconfig = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1202</span>:             <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">6</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 6)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L26;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1203</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1204</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1205</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L26:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1206</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">25</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 26:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1207</span>:             <span class="n">subconfig</span> <span class="o">=</span> <span class="mf">2</span> <span class="p">;</span></pre>
<pre class='cython code score-0 '>      __pyx_v_subconfig = 2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1208</span>:             <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">6</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 6)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L27;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1209</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1210</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1211</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L27:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1212</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">26</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 27:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:             <span class="n">subconfig</span> <span class="o">=</span> <span class="mf">3</span> <span class="p">;</span></pre>
<pre class='cython code score-0 '>      __pyx_v_subconfig = 3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1214</span>:             <span class="k">if</span> <span class="n">test_internal</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">luts</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST13</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="mf">6</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = (__pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(__pyx_v_cell, __pyx_v_luts, __pyx_v_case, __pyx_v_config, __pyx_v_subconfig, ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST13-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST13, __pyx_v_config, 6)) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L28;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1215</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_1</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1216</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1217</span>:                 <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_2</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      /*else*/ {
        __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_5_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L28:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1218</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1219</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">27</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 28:
</pre><pre class="cython line score-0">&#xA0;<span class="">1220</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1221</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1222</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">28</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 29:
</pre><pre class="cython line score-0">&#xA0;<span class="">1223</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1224</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1225</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">29</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 30:
</pre><pre class="cython line score-0">&#xA0;<span class="">1226</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1227</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1228</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">30</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 31:
</pre><pre class="cython line score-0">&#xA0;<span class="">1229</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1230</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1231</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">31</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 32:
</pre><pre class="cython line score-0">&#xA0;<span class="">1232</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1233</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1234</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">32</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 33:
</pre><pre class="cython line score-0">&#xA0;<span class="">1235</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1236</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 5, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1237</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">33</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 34:
</pre><pre class="cython line score-0">&#xA0;<span class="">1238</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1239</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span><span class="mf">6</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 6, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1240</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">34</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 35:
</pre><pre class="cython line score-0">&#xA0;<span class="">1241</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1242</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">7</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 7, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1243</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">35</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 36:
</pre><pre class="cython line score-0">&#xA0;<span class="">1244</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1245</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">8</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 8, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1246</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">36</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 37:
</pre><pre class="cython line score-0">&#xA0;<span class="">1247</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1248</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">9</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 9, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1249</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">37</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 38:
</pre><pre class="cython line score-0">&#xA0;<span class="">1250</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1251</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">10</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 10, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1252</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">38</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 39:
</pre><pre class="cython line score-0">&#xA0;<span class="">1253</span>:             <span class="c">#cell.calculate_center_vertex() # v12 needed</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1254</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_3_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">11</span><span class="p">,</span> <span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_3_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 11, 10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1255</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">39</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 40:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 0, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1258</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">40</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 41:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 1, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1260</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">41</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 42:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 2, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1262</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">42</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 43:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 3, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">43</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 44:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1266</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">44</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 45:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles2</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_2_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">6</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_2_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles2(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 5, 6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1268</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>:         <span class="k">elif</span> <span class="n">subconfig</span><span class="o">==</span><span class="mf">45</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      default:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>:             <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING13_1_</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING13_1_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1271</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1272</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:             <span class="k">print</span><span class="p">(</span><span class="s">&quot;Marching Cubes: Impossible case 13?&quot;</span> <span class="p">)</span></pre>
<pre class='cython code score-2 '>      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_Marching_Cubes_Impossible_case_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1273, __pyx_L1_error)</span>
      break;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1274</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>:     <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">14</span> <span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    default: break;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1276</span>:         <span class="n">cell</span><span class="o">.</span><span class="n">add_triangles</span><span class="p">(</span><span class="n">luts</span><span class="o">.</span><span class="n">TILING14</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = ((PyObject *)__pyx_v_luts-&gt;TILING14);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *)__pyx_v_cell-&gt;__pyx_vtab)-&gt;add_triangles(__pyx_v_cell, ((struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_t_1), __pyx_v_config, 4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1277</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1278</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1279</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">test_face</span><span class="p">(</span><span class="n">Cell</span> <span class="n">cell</span><span class="p">,</span> <span class="nb">int</span> <span class="n">face</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_face(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_cell, int __pyx_v_face) {
  int __pyx_v_absFace;
  double __pyx_v_A;
  double __pyx_v_B;
  double __pyx_v_C;
  double __pyx_v_D;
  double __pyx_v_AC_BD;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test_face", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1280</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; Return True of the face contains part of the surface.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>:     <span class="c"># Get face absolute value</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">absFace</span> <span class="o">=</span> <span class="n">face</span></pre>
<pre class='cython code score-0 '>  __pyx_v_absFace = __pyx_v_face;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1285</span>:     <span class="k">if</span> <span class="n">face</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_face &lt; 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1286</span>:         <span class="n">absFace</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_absFace = (__pyx_v_absFace * -1L);
</pre><pre class="cython line score-0">&#xA0;<span class="">1287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>:     <span class="c"># Get values of corners A B C D</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">A</span><span class="p">,</span> <span class="nf">B</span><span class="p">,</span> <span class="nf">C</span><span class="p">,</span> <span class="nf">D</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1290</span>:     <span class="k">if</span> <span class="n">absFace</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_absFace) {
    case 1:
/* … */
    break;
    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1291</span>:         <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_cell-&gt;v0;
    __pyx_t_3 = __pyx_v_cell-&gt;v4;
    __pyx_t_4 = __pyx_v_cell-&gt;v5;
    __pyx_t_5 = __pyx_v_cell-&gt;v1;
    __pyx_v_A = __pyx_t_2;
    __pyx_v_B = __pyx_t_3;
    __pyx_v_C = __pyx_t_4;
    __pyx_v_D = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1292</span>:     <span class="k">elif</span> <span class="n">absFace</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 3:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1293</span>:         <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_cell-&gt;v1;
    __pyx_t_4 = __pyx_v_cell-&gt;v5;
    __pyx_t_3 = __pyx_v_cell-&gt;v6;
    __pyx_t_2 = __pyx_v_cell-&gt;v2;
    __pyx_v_A = __pyx_t_5;
    __pyx_v_B = __pyx_t_4;
    __pyx_v_C = __pyx_t_3;
    __pyx_v_D = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1294</span>:     <span class="k">elif</span> <span class="n">absFace</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 4:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1295</span>:         <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_cell-&gt;v2;
    __pyx_t_3 = __pyx_v_cell-&gt;v6;
    __pyx_t_4 = __pyx_v_cell-&gt;v7;
    __pyx_t_5 = __pyx_v_cell-&gt;v3;
    __pyx_v_A = __pyx_t_2;
    __pyx_v_B = __pyx_t_3;
    __pyx_v_C = __pyx_t_4;
    __pyx_v_D = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1296</span>:     <span class="k">elif</span> <span class="n">absFace</span> <span class="o">==</span> <span class="mf">4</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 5:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1297</span>:         <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_cell-&gt;v3;
    __pyx_t_4 = __pyx_v_cell-&gt;v7;
    __pyx_t_3 = __pyx_v_cell-&gt;v4;
    __pyx_t_2 = __pyx_v_cell-&gt;v0;
    __pyx_v_A = __pyx_t_5;
    __pyx_v_B = __pyx_t_4;
    __pyx_v_C = __pyx_t_3;
    __pyx_v_D = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1298</span>:     <span class="k">elif</span> <span class="n">absFace</span> <span class="o">==</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 6:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1299</span>:         <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_cell-&gt;v0;
    __pyx_t_3 = __pyx_v_cell-&gt;v3;
    __pyx_t_4 = __pyx_v_cell-&gt;v2;
    __pyx_t_5 = __pyx_v_cell-&gt;v1;
    __pyx_v_A = __pyx_t_2;
    __pyx_v_B = __pyx_t_3;
    __pyx_v_C = __pyx_t_4;
    __pyx_v_D = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1300</span>:     <span class="k">elif</span> <span class="n">absFace</span> <span class="o">==</span> <span class="mf">6</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    default: break;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1301</span>:         <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_cell-&gt;v4;
    __pyx_t_4 = __pyx_v_cell-&gt;v7;
    __pyx_t_3 = __pyx_v_cell-&gt;v6;
    __pyx_t_2 = __pyx_v_cell-&gt;v5;
    __pyx_v_A = __pyx_t_5;
    __pyx_v_B = __pyx_t_4;
    __pyx_v_C = __pyx_t_3;
    __pyx_v_D = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">1302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>:     <span class="c"># Return sign</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1304</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">AC_BD</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">C</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">D</span></pre>
<pre class='cython code score-0 '>  __pyx_v_AC_BD = ((__pyx_v_A * __pyx_v_C) - (__pyx_v_B * __pyx_v_D));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1305</span>:     <span class="k">if</span> <span class="n">AC_BD</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">FLT_EPSILON</span> <span class="ow">and</span> <span class="n">AC_BD</span> <span class="o">&lt;</span> <span class="n">FLT_EPSILON</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((__pyx_v_AC_BD &gt; (-__pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON)) != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_1 = __pyx_t_6;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_6 = ((__pyx_v_AC_BD &lt; __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON) != 0);
  __pyx_t_1 = __pyx_t_6;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1306</span>:         <span class="k">return</span> <span class="n">face</span> <span class="o">&gt;=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_face &gt;= 0);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1307</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1308</span>:         <span class="k">return</span> <span class="n">face</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">AC_BD</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">;</span>  <span class="c"># face and A invert signs</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = (((__pyx_v_face * __pyx_v_A) * __pyx_v_AC_BD) &gt;= 0.0);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1309</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1310</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1311</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">test_internal</span><span class="p">(</span><span class="n">Cell</span> <span class="n">cell</span><span class="p">,</span> <span class="n">LutProvider</span> <span class="n">luts</span><span class="p">,</span> <span class="nb">int</span> <span class="n">case</span><span class="p">,</span> <span class="nb">int</span> <span class="n">config</span><span class="p">,</span> <span class="nb">int</span> <span class="n">subconfig</span><span class="p">,</span> <span class="nb">int</span> <span class="n">s</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>static int __pyx_f_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_test_internal(struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Cell *__pyx_v_cell, struct __pyx_obj_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_LutProvider *__pyx_v_luts, int __pyx_v_case, int __pyx_v_config, int __pyx_v_subconfig, int __pyx_v_s) {
  double __pyx_v_t;
  double __pyx_v_At;
  double __pyx_v_Bt;
  double __pyx_v_Ct;
  double __pyx_v_Dt;
  double __pyx_v_a;
  double __pyx_v_b;
  int __pyx_v_test;
  int __pyx_v_edge;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test_internal", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("simnibs.segmentation._marching_cubes_lewiner_cy.test_internal", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1312</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot; Return True of the face contains part of the surface.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>:     <span class="c"># Typedefs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1316</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">At</span><span class="p">,</span> <span class="nf">Bt</span><span class="p">,</span> <span class="nf">Ct</span><span class="p">,</span> <span class="nf">Dt</span><span class="p">,</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1317</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">test</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_test = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">edge</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span> <span class="c"># reference edge of the triangulation</span></pre>
<pre class='cython code score-0 '>  __pyx_v_edge = -1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1321</span>:     <span class="c"># Calculate At Bt Ct Dt a b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1322</span>:     <span class="c"># Select case 4, 10,  7, 12, 13</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1323</span>:     <span class="n">At</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="n">Ct</span><span class="p">,</span> <span class="n">Dt</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0.0;
  __pyx_t_2 = 0.0;
  __pyx_t_3 = 0.0;
  __pyx_t_4 = 0.0;
  __pyx_v_At = __pyx_t_1;
  __pyx_v_Bt = __pyx_t_2;
  __pyx_v_Ct = __pyx_t_3;
  __pyx_v_Dt = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">1324</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1325</span>:     <span class="k">if</span> <span class="n">case</span><span class="o">==</span><span class="mf">4</span> <span class="ow">or</span> <span class="n">case</span><span class="o">==</span><span class="mf">10</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_case) {
    case 4:
    case 10:
/* … */
    break;
    case 6:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1326</span>:         <span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_a = (((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v0) * (__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v2)) - ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v3) * (__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:         <span class="n">b</span> <span class="o">=</span>  <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">*</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">+</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">*</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">*</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_b = ((((__pyx_v_cell-&gt;v2 * (__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v0)) + (__pyx_v_cell-&gt;v0 * (__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v2))) - (__pyx_v_cell-&gt;v1 * (__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v3))) - (__pyx_v_cell-&gt;v3 * (__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v1)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1328</span>:         <span class="n">t</span> <span class="o">=</span> <span class="o">-</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_t = ((-__pyx_v_b) / ((2.0 * __pyx_v_a) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:         <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mf">0</span> <span class="ow">or</span> <span class="n">t</span><span class="o">&gt;</span><span class="mf">1</span><span class="p">:</span>  <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span> <span class="p">;</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = ((__pyx_v_t &lt; 0.0) != 0);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L4_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_t &gt; 1.0) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L4_bool_binop_done:;
    if (__pyx_t_5) {
      __pyx_r = (__pyx_v_s &gt; 0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>:         <span class="n">At</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    __pyx_v_At = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:         <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    __pyx_v_Bt = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1333</span>:         <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    __pyx_v_Ct = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>:         <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    __pyx_v_Dt = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">1335</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:     <span class="k">elif</span> <span class="n">case</span><span class="o">==</span><span class="mf">6</span> <span class="ow">or</span> <span class="n">case</span><span class="o">==</span><span class="mf">7</span> <span class="ow">or</span> <span class="n">case</span><span class="o">==</span><span class="mf">12</span> <span class="ow">or</span> <span class="n">case</span><span class="o">==</span><span class="mf">13</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    case 7:
    case 12:
    case 13:
/* … */
    break;
    default:
</pre><pre class="cython line score-0">&#xA0;<span class="">1337</span>:         <span class="c"># Define edge</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:         <span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">6</span><span class="p">:</span>  <span class="n">edge</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST6</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    switch (__pyx_v_case) {
      case 6:
      __pyx_v_edge = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST6-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST6, __pyx_v_config, 2);
      break;
      case 7:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>:         <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">7</span><span class="p">:</span> <span class="n">edge</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST7</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_edge = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST7-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST7, __pyx_v_config, 4);
      break;
      case 12:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1340</span>:         <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">12</span><span class="p">:</span> <span class="n">edge</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">TEST12</span><span class="o">.</span><span class="n">get2</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_edge = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TEST12-&gt;__pyx_vtab)-&gt;get2(__pyx_v_luts-&gt;TEST12, __pyx_v_config, 3);
      break;
      case 13:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:         <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">13</span><span class="p">:</span> <span class="n">edge</span> <span class="o">=</span> <span class="n">luts</span><span class="o">.</span><span class="n">TILING13_5_1</span><span class="o">.</span><span class="n">get3</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">subconfig</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_edge = ((struct __pyx_vtabstruct_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_Lut *)__pyx_v_luts-&gt;TILING13_5_1-&gt;__pyx_vtab)-&gt;get3(__pyx_v_luts-&gt;TILING13_5_1, __pyx_v_config, __pyx_v_subconfig, 0);
      break;
      default: break;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1342</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:         <span class="k">if</span> <span class="n">edge</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    switch (__pyx_v_edge) {
      case 0:
/* … */
      break;
      case 1:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v0 / ((__pyx_v_cell-&gt;v0 - __pyx_v_cell-&gt;v1) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1345</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1346</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v2 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1347</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v7 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v7) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v4 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v4) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1349</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1350</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v1 / ((__pyx_v_cell-&gt;v1 - __pyx_v_cell-&gt;v2) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1352</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v3 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1353</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v4 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v4) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1354</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v5 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v5) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 3:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1356</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v2 / ((__pyx_v_cell-&gt;v2 - __pyx_v_cell-&gt;v3) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1357</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1358</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v0 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1359</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v5 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v5) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1360</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v6 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v6) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1361</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 4:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1362</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v3 / ((__pyx_v_cell-&gt;v3 - __pyx_v_cell-&gt;v0) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1363</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1364</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v1 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1365</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v6 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v6) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1366</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v7 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v7) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1367</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">4</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 5:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1368</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v4 / ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v5) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1369</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v7 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v7) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1371</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v2 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1372</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v1 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1373</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 6:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1374</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v5 / ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v6) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1375</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1376</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v4 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v4) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1377</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v3 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1378</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v2 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1379</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">6</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 7:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1380</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v6 / ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v7) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1381</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1382</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v5 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v5) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1383</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v0 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1384</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v3 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1385</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">7</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 8:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1386</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v7 / ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v4) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1387</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1388</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v6 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v6) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1389</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v1 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1390</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v0 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1391</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">8</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 9:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1392</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v0 / ((__pyx_v_cell-&gt;v0 - __pyx_v_cell-&gt;v4) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1393</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1394</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1395</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1396</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1397</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">9</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 10:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1398</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v1 / ((__pyx_v_cell-&gt;v1 - __pyx_v_cell-&gt;v5) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1400</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1401</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1402</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1403</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">10</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      case 11:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1404</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v2 / ((__pyx_v_cell-&gt;v2 - __pyx_v_cell-&gt;v6) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1405</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1406</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1407</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1408</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v3 + ((__pyx_v_cell-&gt;v7 - __pyx_v_cell-&gt;v3) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1409</span>:         <span class="k">elif</span> <span class="n">edge</span><span class="o">==</span><span class="mf">11</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1410</span>:             <span class="n">t</span>  <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">/</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v3</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v7</span> <span class="o">+</span> <span class="n">FLT_EPSILON</span> <span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_t = (__pyx_v_cell-&gt;v3 / ((__pyx_v_cell-&gt;v3 - __pyx_v_cell-&gt;v7) + __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1411</span>:             <span class="n">At</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_v_At = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1412</span>:             <span class="n">Bt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v6</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v2</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Bt = (__pyx_v_cell-&gt;v2 + ((__pyx_v_cell-&gt;v6 - __pyx_v_cell-&gt;v2) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1413</span>:             <span class="n">Ct</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v5</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Ct = (__pyx_v_cell-&gt;v1 + ((__pyx_v_cell-&gt;v5 - __pyx_v_cell-&gt;v1) * __pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1414</span>:             <span class="n">Dt</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="o">+</span> <span class="p">(</span> <span class="n">cell</span><span class="o">.</span><span class="n">v4</span> <span class="o">-</span> <span class="n">cell</span><span class="o">.</span><span class="n">v0</span> <span class="p">)</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Dt = (__pyx_v_cell-&gt;v0 + ((__pyx_v_cell-&gt;v4 - __pyx_v_cell-&gt;v0) * __pyx_v_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">1415</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1416</span>:              <span class="k">print</span><span class="p">(</span> <span class="s">&quot;Invalid edge </span><span class="si">%i</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">edge</span> <span class="p">)</span></pre>
<pre class='cython code score-8 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_edge);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1416, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Invalid_edge_i, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1416, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1416, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      break;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1417</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1418</span>:         <span class="k">print</span><span class="p">(</span> <span class="s">&quot;Invalid ambiguous case </span><span class="si">%i</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="n">case</span> <span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_case);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1418, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Invalid_ambiguous_case_i, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1418, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1418, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    break;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1419</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>:     <span class="c"># Process results</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1421</span>:     <span class="k">if</span> <span class="n">At</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span> <span class="n">test</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((__pyx_v_At &gt;= 0.0) != 0);
  if (__pyx_t_5) {
    __pyx_v_test = (__pyx_v_test + 1);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1422</span>:     <span class="k">if</span> <span class="n">Bt</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span> <span class="n">test</span> <span class="o">+=</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((__pyx_v_Bt &gt;= 0.0) != 0);
  if (__pyx_t_5) {
    __pyx_v_test = (__pyx_v_test + 2);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1423</span>:     <span class="k">if</span> <span class="n">Ct</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span> <span class="n">test</span> <span class="o">+=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((__pyx_v_Ct &gt;= 0.0) != 0);
  if (__pyx_t_5) {
    __pyx_v_test = (__pyx_v_test + 4);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1424</span>:     <span class="k">if</span> <span class="n">Dt</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span> <span class="n">test</span> <span class="o">+=</span> <span class="mf">8</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((__pyx_v_Dt &gt;= 0.0) != 0);
  if (__pyx_t_5) {
    __pyx_v_test = (__pyx_v_test + 8);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1426</span>:     <span class="c"># Determine what to return</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1427</span>:     <span class="k">if</span> <span class="n">test</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_test) {
    case 0:
    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 1:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1428</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 2:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1429</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 3:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1430</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">3</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 4:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1431</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">4</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 5:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1432</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 6:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>:         <span class="k">if</span> <span class="n">At</span> <span class="o">*</span> <span class="n">Ct</span> <span class="o">-</span> <span class="n">Bt</span> <span class="o">*</span> <span class="n">Dt</span> <span class="o">&lt;</span>  <span class="n">FLT_EPSILON</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = ((((__pyx_v_At * __pyx_v_Ct) - (__pyx_v_Bt * __pyx_v_Dt)) &lt; __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON) != 0);
    if (__pyx_t_5) {
      __pyx_r = (__pyx_v_s &gt; 0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1434</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">6</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 7:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1435</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">7</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&lt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &lt; 0);
    goto __pyx_L0;
    break;
    case 8:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1436</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">8</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 9:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1437</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">9</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 10:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">10</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    case 11:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:         <span class="k">if</span> <span class="n">At</span> <span class="o">*</span> <span class="n">Ct</span> <span class="o">-</span> <span class="n">Bt</span> <span class="o">*</span> <span class="n">Dt</span> <span class="o">&gt;=</span> <span class="n">FLT_EPSILON</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = ((((__pyx_v_At * __pyx_v_Ct) - (__pyx_v_Bt * __pyx_v_Dt)) &gt;= __pyx_v_7simnibs_12segmentation_26_marching_cubes_lewiner_cy_FLT_EPSILON) != 0);
    if (__pyx_t_5) {
      __pyx_r = (__pyx_v_s &gt; 0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1440</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">11</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&lt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &lt; 0);
    goto __pyx_L0;
    break;
    case 12:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">12</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &gt; 0);
    goto __pyx_L0;
    break;
    case 13:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1442</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">13</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&lt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &lt; 0);
    goto __pyx_L0;
    break;
    case 14:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1443</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">14</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&lt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &lt; 0);
    goto __pyx_L0;
    break;
    case 15:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1444</span>:     <span class="k">elif</span> <span class="n">test</span><span class="o">==</span><span class="mf">15</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&lt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &lt; 0);
    goto __pyx_L0;
    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1445</span>:     <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span><span class="o">&lt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_s &lt; 0);
    goto __pyx_L0;
    break;
  }
</pre></div></body></html>
